// Validating benchmarks:
// ***** BenchmarkRunner: Start   *****
// ***** Found 28 benchmark(s) in total *****
// ***** Building 1 exe(s) in Parallel: Start   *****
// start dotnet  restore /p:UseSharedCompilation=false /p:BuildInParallel=false /m:1 /p:Deterministic=true /p:Optimize=true /p:IntermediateOutputPath="/home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/obj/Release/net10.0/" /p:OutDir="/home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/bin/Release/net10.0/" /p:OutputPath="/home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/bin/Release/net10.0/" in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32
// command took 0.95 sec and exited with 0
// start dotnet  build -c Release --no-restore /p:UseSharedCompilation=false /p:BuildInParallel=false /m:1 /p:Deterministic=true /p:Optimize=true /p:IntermediateOutputPath="/home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/obj/Release/net10.0/" /p:OutDir="/home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/bin/Release/net10.0/" /p:OutputPath="/home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/bin/Release/net10.0/" --output "/home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/bin/Release/net10.0/" in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32
// command took 11.88 sec and exited with 0
// ***** Done, took 00:00:12 (12.9 sec)   *****
// Found 28 benchmarks:
//   ProducerBenchmarks.'Dekaf: Single Message Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=100, BatchSize=100]
//   ProducerBenchmarks.'Confluent: Single Message Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=100, BatchSize=100]
//   ProducerBenchmarks.'Dekaf: Batch Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=100, BatchSize=100]
//   ProducerBenchmarks.'Confluent: Batch Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=100, BatchSize=100]
//   ProducerBenchmarks.'Dekaf: Fire-and-Forget Send': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=100, BatchSize=100]
//   ProducerBenchmarks.'Dekaf: Fire-and-Forget Direct': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=100, BatchSize=100]
//   ProducerBenchmarks.'Confluent: Fire-and-Forget Produce': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=100, BatchSize=100]
//   ProducerBenchmarks.'Dekaf: Single Message Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=100, BatchSize=1000]
//   ProducerBenchmarks.'Confluent: Single Message Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=100, BatchSize=1000]
//   ProducerBenchmarks.'Dekaf: Batch Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=100, BatchSize=1000]
//   ProducerBenchmarks.'Confluent: Batch Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=100, BatchSize=1000]
//   ProducerBenchmarks.'Dekaf: Fire-and-Forget Send': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=100, BatchSize=1000]
//   ProducerBenchmarks.'Dekaf: Fire-and-Forget Direct': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=100, BatchSize=1000]
//   ProducerBenchmarks.'Confluent: Fire-and-Forget Produce': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=100, BatchSize=1000]
//   ProducerBenchmarks.'Dekaf: Single Message Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=1000, BatchSize=100]
//   ProducerBenchmarks.'Confluent: Single Message Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=1000, BatchSize=100]
//   ProducerBenchmarks.'Dekaf: Batch Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=1000, BatchSize=100]
//   ProducerBenchmarks.'Confluent: Batch Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=1000, BatchSize=100]
//   ProducerBenchmarks.'Dekaf: Fire-and-Forget Send': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=1000, BatchSize=100]
//   ProducerBenchmarks.'Dekaf: Fire-and-Forget Direct': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=1000, BatchSize=100]
//   ProducerBenchmarks.'Confluent: Fire-and-Forget Produce': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=1000, BatchSize=100]
//   ProducerBenchmarks.'Dekaf: Single Message Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=1000, BatchSize=1000]
//   ProducerBenchmarks.'Confluent: Single Message Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=1000, BatchSize=1000]
//   ProducerBenchmarks.'Dekaf: Batch Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=1000, BatchSize=1000]
//   ProducerBenchmarks.'Confluent: Batch Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=1000, BatchSize=1000]
//   ProducerBenchmarks.'Dekaf: Fire-and-Forget Send': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=1000, BatchSize=1000]
//   ProducerBenchmarks.'Dekaf: Fire-and-Forget Direct': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=1000, BatchSize=1000]
//   ProducerBenchmarks.'Confluent: Fire-and-Forget Produce': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=1000, BatchSize=1000]

// **************************
// Benchmark: ProducerBenchmarks.'Dekaf: Single Message Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=100, BatchSize=100]
// *** Execute ***
// Launch: 1 / 1
// Execute: dotnet 8d2c821d-2520-4124-9cd5-dd795016bb32.dll --anonymousPipes 126 127 --benchmarkName "Dekaf.Benchmarks.ProducerBenchmarks.SingleProduce_Dekaf(MessageSize: 100, BatchSize: 100)" --job "InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3" --benchmarkId 0 in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/bin/Release/net10.0
// Failed to set up high priority (Permission denied). In order to run benchmarks with high priority, make sure you have the right permissions.
// BeforeAnythingElse

// Benchmark Process Environment Information:
// BenchmarkDotNet v0.14.0
// Runtime=.NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2
// GC=Concurrent Workstation
// HardwareIntrinsics=AVX2,AES,BMI1,BMI2,FMA,LZCNT,PCLMUL,POPCNT,AvxVnni,SERIALIZE VectorSize=256
// Job: Job-CLZANV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3)

Starting Kafka container via Testcontainers...
[testcontainers.org 00:00:00.09] Connected to Docker:
  Host: unix:///var/run/docker.sock
  Server Version: 29.2.0
  Kernel Version: 6.17.0-8-generic
  API Version: 1.53
  Operating System: Ubuntu 25.10
  Total Memory: 30.58 GB
[testcontainers.org 00:00:00.12] Docker config "/home/tom-longhurst/.docker/config.json" not found
[testcontainers.org 00:00:00.12] Searching Docker registry credential in Auths
[testcontainers.org 00:00:00.12] Docker registry credential https://index.docker.io/v1/ not found
[testcontainers.org 00:00:02.02] Docker image testcontainers/ryuk:0.14.0 created
[testcontainers.org 00:00:02.09] Docker container d0adf63ec5c8 created
[testcontainers.org 00:00:02.12] Start Docker container d0adf63ec5c8
[testcontainers.org 00:00:02.30] Wait for Docker container d0adf63ec5c8 to complete readiness checks
[testcontainers.org 00:00:02.30] Docker container d0adf63ec5c8 ready
[testcontainers.org 00:00:37.19] Docker image confluentinc/cp-kafka:7.5.0 created
[testcontainers.org 00:00:37.60] Docker container 6f801a089ea0 created
[testcontainers.org 00:00:37.60] Start Docker container 6f801a089ea0
[testcontainers.org 00:00:37.74] Add file to tar archive: Content length: 390 byte(s), Target file: "/testcontainers.sh", UID: 0, GID: 0, Mode: 0755
[testcontainers.org 00:00:37.75] Copy tar archive to container: Content length: 390 byte(s), Docker container: 6f801a089ea0
[testcontainers.org 00:00:37.75] Wait for Docker container 6f801a089ea0 to complete readiness checks
[testcontainers.org 00:00:40.78] Docker container 6f801a089ea0 ready
Kafka started at plaintext://127.0.0.1:32770/
Waiting for Kafka to be ready...
Kafka is ready with 1 broker(s)
[testcontainers.org 00:00:41.01] Execute "kafka-topics --bootstrap-server localhost:9092 --create --topic benchmark-producer --partitions 3 --replication-factor 1" at Docker container 6f801a089ea0
Warning: Failed to create topic benchmark-producer: [2026-01-27 23:14:37,006] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:14:37,061] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:14:37,141] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:14:37,342] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:14:37,764] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:14:38,494] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:14:39,301] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:14:40,253] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:14:41,083] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:14:41,990] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:14:43,055] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:14:44,172] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:14:45,151] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:14:46,098] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:14:47,250] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:14:48,126] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:14:49,100] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:14:50,121] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:14:50,969] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:14:51,991] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:14:52,972] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:14:53,877] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:14:54,750] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:14:55,937] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:14:57,117] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:14:58,284] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:14:59,239] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:00,141] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:01,216] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:02,398] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:03,378] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:04,517] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:05,410] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:06,382] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:07,338] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:08,518] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:09,563] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:10,493] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:11,410] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:12,373] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:13,569] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:14,405] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:15,508] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:16,380] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:17,297] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:18,364] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:19,549] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:20,660] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:21,702] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:22,577] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:23,411] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:24,227] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:25,309] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:26,195] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:27,279] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:28,109] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:29,108] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:29,985] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:31,009] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:32,054] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:32,963] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:33,959] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:34,936] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:35,791] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:36,789] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32770) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:36,885] ERROR org.apache.kafka.common.errors.TimeoutException: Timed out waiting for a node assignment. Call: createTopics
 (kafka.admin.TopicCommand$)

System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.
 ---> System.InvalidOperationException: Failed to refresh metadata from any broker
   at Dekaf.Metadata.MetadataManager.RefreshMetadataInternalAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 278
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 218
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 204
   at Dekaf.Metadata.MetadataManager.InitializeAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 105
   at Dekaf.Producer.KafkaProducer`2.ProduceInternalAsync(ProducerMessage`2 message, PooledValueTaskSource`1 completion, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 970
   at Dekaf.Producer.KafkaProducer`2.ProcessWorkAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 950
   at Dekaf.Producer.PooledValueTaskSource`1.System.Threading.Tasks.Sources.IValueTaskSource<T>.GetResult(Int16 token) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/PooledValueTaskSource.cs:line 145
   at Dekaf.Producer.KafkaProducer`2.ProduceAsyncSlow(ProducerMessage`2 message, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 287
   at Dekaf.Benchmarks.ProducerBenchmarks.WarmupAsync() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 67
   at Dekaf.Benchmarks.ProducerBenchmarks.Setup() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 59
   at BenchmarkDotNet.Helpers.AwaitHelper.GetResult(Task task)
   at BenchmarkDotNet.Autogenerated.Runnable_0.<.ctor>b__3_0() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 196
   at BenchmarkDotNet.Engines.EngineFactory.CreateReadyToRun(EngineParameters engineParameters)
   at BenchmarkDotNet.Autogenerated.Runnable_0.Run(IHost host, String benchmarkName) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 180
   at System.Reflection.MethodBaseInvoker.InterpretedInvoke_Method(Object obj, IntPtr* args)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   --- End of inner exception stack trace ---
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at BenchmarkDotNet.Autogenerated.UniqueProgramName.AfterAssemblyLoadingAttached(String[] args) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 57
// AfterAll
No Workload Results were obtained from the run.
// Benchmark Process 1247770 has exited with code 255.

// ** Remained 27 (96.4%) benchmark(s) to run. Estimated finish 2026-01-28 0:01 (0h 45m from now) **
// **************************
// Benchmark: ProducerBenchmarks.'Confluent: Single Message Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=100, BatchSize=100]
// *** Execute ***
// Launch: 1 / 1
// Execute: dotnet 8d2c821d-2520-4124-9cd5-dd795016bb32.dll --anonymousPipes 126 127 --benchmarkName "Dekaf.Benchmarks.ProducerBenchmarks.SingleProduce_Confluent(MessageSize: 100, BatchSize: 100)" --job "InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3" --benchmarkId 1 in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/bin/Release/net10.0
// Failed to set up high priority (Permission denied). In order to run benchmarks with high priority, make sure you have the right permissions.
// BeforeAnythingElse

// Benchmark Process Environment Information:
// BenchmarkDotNet v0.14.0
// Runtime=.NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2
// GC=Concurrent Workstation
// HardwareIntrinsics=AVX2,AES,BMI1,BMI2,FMA,LZCNT,PCLMUL,POPCNT,AvxVnni,SERIALIZE VectorSize=256
// Job: Job-TOOKNY(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3)

Starting Kafka container via Testcontainers...
[testcontainers.org 00:00:00.08] Connected to Docker:
  Host: unix:///var/run/docker.sock
  Server Version: 29.2.0
  Kernel Version: 6.17.0-8-generic
  API Version: 1.53
  Operating System: Ubuntu 25.10
  Total Memory: 30.58 GB
[testcontainers.org 00:00:00.20] Docker container 13f2e4776f13 created
[testcontainers.org 00:00:00.23] Start Docker container 13f2e4776f13
[testcontainers.org 00:00:00.33] Wait for Docker container 13f2e4776f13 to complete readiness checks
[testcontainers.org 00:00:00.33] Docker container 13f2e4776f13 ready
[testcontainers.org 00:00:02.39] Docker container c1465ebdbc69 created
[testcontainers.org 00:00:02.40] Start Docker container c1465ebdbc69
[testcontainers.org 00:00:02.54] Add file to tar archive: Content length: 390 byte(s), Target file: "/testcontainers.sh", UID: 0, GID: 0, Mode: 0755
[testcontainers.org 00:00:02.55] Copy tar archive to container: Content length: 390 byte(s), Docker container: c1465ebdbc69
[testcontainers.org 00:00:02.55] Wait for Docker container c1465ebdbc69 to complete readiness checks
[testcontainers.org 00:00:05.59] Docker container c1465ebdbc69 ready
Kafka started at plaintext://127.0.0.1:32774/
Waiting for Kafka to be ready...
Kafka is ready with 1 broker(s)
[testcontainers.org 00:00:05.83] Execute "kafka-topics --bootstrap-server localhost:9092 --create --topic benchmark-producer --partitions 3 --replication-factor 1" at Docker container c1465ebdbc69
Warning: Failed to create topic benchmark-producer: [2026-01-27 23:15:43,817] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:43,865] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:43,952] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:44,152] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:44,485] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:45,445] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:46,465] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:47,281] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:48,107] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:48,999] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:49,982] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:50,808] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:51,784] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:52,942] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:53,964] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:55,085] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:56,222] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:57,055] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:58,117] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:15:59,179] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:00,071] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:00,907] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:01,800] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:02,645] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:03,628] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:04,472] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:05,557] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:06,556] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:07,503] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:08,353] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:09,214] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:10,172] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:11,139] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:11,977] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:13,131] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:14,160] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:14,988] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:16,145] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:17,134] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:18,142] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:19,112] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:20,240] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:21,234] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:22,242] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:23,177] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:24,322] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:25,270] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:26,100] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:27,051] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:28,010] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:28,961] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:29,836] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:31,017] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:31,921] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:33,028] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:34,037] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:34,973] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:36,038] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:36,931] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:37,896] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:38,925] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:39,889] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:40,800] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:41,861] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:42,767] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32774) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:43,701] ERROR org.apache.kafka.common.errors.TimeoutException: Timed out waiting for a node assignment. Call: createTopics
 (kafka.admin.TopicCommand$)

System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.
 ---> System.InvalidOperationException: Failed to refresh metadata from any broker
   at Dekaf.Metadata.MetadataManager.RefreshMetadataInternalAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 278
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 218
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 204
   at Dekaf.Metadata.MetadataManager.InitializeAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 105
   at Dekaf.Producer.KafkaProducer`2.ProduceInternalAsync(ProducerMessage`2 message, PooledValueTaskSource`1 completion, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 970
   at Dekaf.Producer.KafkaProducer`2.ProcessWorkAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 950
   at Dekaf.Producer.PooledValueTaskSource`1.System.Threading.Tasks.Sources.IValueTaskSource<T>.GetResult(Int16 token) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/PooledValueTaskSource.cs:line 145
   at Dekaf.Producer.KafkaProducer`2.ProduceAsyncSlow(ProducerMessage`2 message, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 287
   at Dekaf.Benchmarks.ProducerBenchmarks.WarmupAsync() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 67
   at Dekaf.Benchmarks.ProducerBenchmarks.Setup() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 59
   at BenchmarkDotNet.Helpers.AwaitHelper.GetResult(Task task)
   at BenchmarkDotNet.Autogenerated.Runnable_1.<.ctor>b__3_0() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 378
   at BenchmarkDotNet.Engines.EngineFactory.CreateReadyToRun(EngineParameters engineParameters)
   at BenchmarkDotNet.Autogenerated.Runnable_1.Run(IHost host, String benchmarkName) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 362
   at System.Reflection.MethodBaseInvoker.InterpretedInvoke_Method(Object obj, IntPtr* args)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   --- End of inner exception stack trace ---
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at BenchmarkDotNet.Autogenerated.UniqueProgramName.AfterAssemblyLoadingAttached(String[] args) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 57
// AfterAll
No Workload Results were obtained from the run.
// Benchmark Process 1257984 has exited with code 255.

// ** Remained 26 (92.9%) benchmark(s) to run. Estimated finish 2026-01-27 23:53 (0h 36m from now) **
// **************************
// Benchmark: ProducerBenchmarks.'Dekaf: Batch Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=100, BatchSize=100]
// *** Execute ***
// Launch: 1 / 1
// Execute: dotnet 8d2c821d-2520-4124-9cd5-dd795016bb32.dll --anonymousPipes 126 127 --benchmarkName "Dekaf.Benchmarks.ProducerBenchmarks.BatchProduce_Dekaf(MessageSize: 100, BatchSize: 100)" --job "InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3" --benchmarkId 2 in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/bin/Release/net10.0
// Failed to set up high priority (Permission denied). In order to run benchmarks with high priority, make sure you have the right permissions.
// BeforeAnythingElse

// Benchmark Process Environment Information:
// BenchmarkDotNet v0.14.0
// Runtime=.NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2
// GC=Concurrent Workstation
// HardwareIntrinsics=AVX2,AES,BMI1,BMI2,FMA,LZCNT,PCLMUL,POPCNT,AvxVnni,SERIALIZE VectorSize=256
// Job: Job-AJSEXF(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3)

Starting Kafka container via Testcontainers...
[testcontainers.org 00:00:00.09] Connected to Docker:
  Host: unix:///var/run/docker.sock
  Server Version: 29.2.0
  Kernel Version: 6.17.0-8-generic
  API Version: 1.53
  Operating System: Ubuntu 25.10
  Total Memory: 30.58 GB
[testcontainers.org 00:00:00.20] Docker container e4c4a4591a5d created
[testcontainers.org 00:00:00.22] Start Docker container e4c4a4591a5d
[testcontainers.org 00:00:00.35] Wait for Docker container e4c4a4591a5d to complete readiness checks
[testcontainers.org 00:00:00.35] Docker container e4c4a4591a5d ready
[testcontainers.org 00:00:02.44] Docker container ffb0eab5c71c created
[testcontainers.org 00:00:02.45] Start Docker container ffb0eab5c71c
[testcontainers.org 00:00:02.57] Add file to tar archive: Content length: 390 byte(s), Target file: "/testcontainers.sh", UID: 0, GID: 0, Mode: 0755
[testcontainers.org 00:00:02.58] Copy tar archive to container: Content length: 390 byte(s), Docker container: ffb0eab5c71c
[testcontainers.org 00:00:02.58] Wait for Docker container ffb0eab5c71c to complete readiness checks
[testcontainers.org 00:00:05.62] Docker container ffb0eab5c71c ready
Kafka started at plaintext://127.0.0.1:32778/
Waiting for Kafka to be ready...
Kafka is ready with 1 broker(s)
[testcontainers.org 00:00:05.86] Execute "kafka-topics --bootstrap-server localhost:9092 --create --topic benchmark-producer --partitions 3 --replication-factor 1" at Docker container ffb0eab5c71c
Warning: Failed to create topic benchmark-producer: [2026-01-27 23:16:50,651] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:50,704] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:50,801] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:50,994] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:51,337] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:52,205] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:53,196] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:54,215] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:55,042] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:56,126] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:57,011] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:57,895] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:58,890] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:16:59,999] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:00,965] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:02,139] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:03,203] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:04,273] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:05,388] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:06,526] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:07,567] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:08,527] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:09,466] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:10,307] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:11,462] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:12,322] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:13,252] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:14,236] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:15,308] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:16,475] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:17,591] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:18,464] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:19,507] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:20,630] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:21,526] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:22,328] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:23,386] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:24,255] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:25,145] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:25,967] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:27,033] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:27,943] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:29,073] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:29,998] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:31,082] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:32,266] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:33,191] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:34,262] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:35,140] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:36,024] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:36,844] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:37,987] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:39,087] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:40,087] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:41,228] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:42,268] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:43,394] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:44,293] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:45,470] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:46,554] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:47,440] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:48,423] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:49,525] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32778) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:50,536] ERROR org.apache.kafka.common.errors.TimeoutException: Timed out waiting for a node assignment. Call: createTopics
 (kafka.admin.TopicCommand$)

System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.
 ---> System.InvalidOperationException: Failed to refresh metadata from any broker
   at Dekaf.Metadata.MetadataManager.RefreshMetadataInternalAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 278
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 218
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 204
   at Dekaf.Metadata.MetadataManager.InitializeAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 105
   at Dekaf.Producer.KafkaProducer`2.ProduceInternalAsync(ProducerMessage`2 message, PooledValueTaskSource`1 completion, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 970
   at Dekaf.Producer.KafkaProducer`2.ProcessWorkAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 950
   at Dekaf.Producer.PooledValueTaskSource`1.System.Threading.Tasks.Sources.IValueTaskSource<T>.GetResult(Int16 token) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/PooledValueTaskSource.cs:line 145
   at Dekaf.Producer.KafkaProducer`2.ProduceAsyncSlow(ProducerMessage`2 message, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 287
   at Dekaf.Benchmarks.ProducerBenchmarks.WarmupAsync() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 67
   at Dekaf.Benchmarks.ProducerBenchmarks.Setup() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 59
   at BenchmarkDotNet.Helpers.AwaitHelper.GetResult(Task task)
   at BenchmarkDotNet.Autogenerated.Runnable_2.<.ctor>b__3_0() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 549
   at BenchmarkDotNet.Engines.EngineFactory.CreateReadyToRun(EngineParameters engineParameters)
   at BenchmarkDotNet.Autogenerated.Runnable_2.Run(IHost host, String benchmarkName) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 533
   at System.Reflection.MethodBaseInvoker.InterpretedInvoke_Method(Object obj, IntPtr* args)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   --- End of inner exception stack trace ---
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at BenchmarkDotNet.Autogenerated.UniqueProgramName.AfterAssemblyLoadingAttached(String[] args) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 57
// AfterAll
No Workload Results were obtained from the run.
// Benchmark Process 1264888 has exited with code 255.

// ** Remained 25 (89.3%) benchmark(s) to run. Estimated finish 2026-01-27 23:50 (0h 32m from now) **
// **************************
// Benchmark: ProducerBenchmarks.'Confluent: Batch Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=100, BatchSize=100]
// *** Execute ***
// Launch: 1 / 1
// Execute: dotnet 8d2c821d-2520-4124-9cd5-dd795016bb32.dll --anonymousPipes 126 127 --benchmarkName "Dekaf.Benchmarks.ProducerBenchmarks.BatchProduce_Confluent(MessageSize: 100, BatchSize: 100)" --job "InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3" --benchmarkId 3 in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/bin/Release/net10.0
// Failed to set up high priority (Permission denied). In order to run benchmarks with high priority, make sure you have the right permissions.
// BeforeAnythingElse

// Benchmark Process Environment Information:
// BenchmarkDotNet v0.14.0
// Runtime=.NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2
// GC=Concurrent Workstation
// HardwareIntrinsics=AVX2,AES,BMI1,BMI2,FMA,LZCNT,PCLMUL,POPCNT,AvxVnni,SERIALIZE VectorSize=256
// Job: Job-VVVFVB(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3)

Starting Kafka container via Testcontainers...
[testcontainers.org 00:00:00.09] Connected to Docker:
  Host: unix:///var/run/docker.sock
  Server Version: 29.2.0
  Kernel Version: 6.17.0-8-generic
  API Version: 1.53
  Operating System: Ubuntu 25.10
  Total Memory: 30.58 GB
[testcontainers.org 00:00:00.20] Docker container 2b2ccde3ad6f created
[testcontainers.org 00:00:00.23] Start Docker container 2b2ccde3ad6f
[testcontainers.org 00:00:00.33] Wait for Docker container 2b2ccde3ad6f to complete readiness checks
[testcontainers.org 00:00:00.33] Docker container 2b2ccde3ad6f ready
[testcontainers.org 00:00:02.41] Docker container 594824ad7869 created
[testcontainers.org 00:00:02.41] Start Docker container 594824ad7869
[testcontainers.org 00:00:02.53] Add file to tar archive: Content length: 390 byte(s), Target file: "/testcontainers.sh", UID: 0, GID: 0, Mode: 0755
[testcontainers.org 00:00:02.54] Copy tar archive to container: Content length: 390 byte(s), Docker container: 594824ad7869
[testcontainers.org 00:00:02.54] Wait for Docker container 594824ad7869 to complete readiness checks
[testcontainers.org 00:00:05.58] Docker container 594824ad7869 ready
Kafka started at plaintext://127.0.0.1:32782/
Waiting for Kafka to be ready...
Kafka is ready with 1 broker(s)
[testcontainers.org 00:00:05.83] Execute "kafka-topics --bootstrap-server localhost:9092 --create --topic benchmark-producer --partitions 3 --replication-factor 1" at Docker container 594824ad7869
Warning: Failed to create topic benchmark-producer: [2026-01-27 23:17:57,457] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:57,505] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:57,586] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:57,768] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:58,156] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:59,024] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:17:59,995] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:01,028] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:02,138] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:03,014] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:03,986] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:04,789] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:05,644] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:06,556] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:07,541] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:08,553] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:09,663] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:10,759] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:11,741] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:12,555] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:13,682] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:14,829] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:15,777] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:16,638] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:17,572] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:18,512] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:19,332] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:20,242] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:21,173] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:22,039] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:23,167] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:24,228] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:25,340] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:26,190] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:27,025] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:27,908] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:28,894] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:29,922] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:31,102] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:31,960] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:32,891] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:34,004] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:35,182] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:36,117] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:37,172] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:38,317] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:39,479] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:40,658] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:41,533] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:42,453] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:43,433] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:44,251] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:45,396] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:46,448] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:47,359] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:48,348] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:49,284] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:50,104] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:51,263] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:52,336] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:53,315] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:54,178] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:55,284] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:56,141] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:57,280] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32782) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:18:57,346] ERROR org.apache.kafka.common.errors.TimeoutException: Timed out waiting for a node assignment. Call: createTopics
 (kafka.admin.TopicCommand$)

System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.
 ---> System.InvalidOperationException: Failed to refresh metadata from any broker
   at Dekaf.Metadata.MetadataManager.RefreshMetadataInternalAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 278
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 218
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 204
   at Dekaf.Metadata.MetadataManager.InitializeAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 105
   at Dekaf.Producer.KafkaProducer`2.ProduceInternalAsync(ProducerMessage`2 message, PooledValueTaskSource`1 completion, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 970
   at Dekaf.Producer.KafkaProducer`2.ProcessWorkAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 950
   at Dekaf.Producer.PooledValueTaskSource`1.System.Threading.Tasks.Sources.IValueTaskSource<T>.GetResult(Int16 token) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/PooledValueTaskSource.cs:line 145
   at Dekaf.Producer.KafkaProducer`2.ProduceAsyncSlow(ProducerMessage`2 message, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 287
   at Dekaf.Benchmarks.ProducerBenchmarks.WarmupAsync() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 67
   at Dekaf.Benchmarks.ProducerBenchmarks.Setup() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 59
   at BenchmarkDotNet.Helpers.AwaitHelper.GetResult(Task task)
   at BenchmarkDotNet.Autogenerated.Runnable_3.<.ctor>b__3_0() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 715
   at BenchmarkDotNet.Engines.EngineFactory.CreateReadyToRun(EngineParameters engineParameters)
   at BenchmarkDotNet.Autogenerated.Runnable_3.Run(IHost host, String benchmarkName) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 699
   at System.Reflection.MethodBaseInvoker.InterpretedInvoke_Method(Object obj, IntPtr* args)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   --- End of inner exception stack trace ---
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at BenchmarkDotNet.Autogenerated.UniqueProgramName.AfterAssemblyLoadingAttached(String[] args) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 57
// AfterAll
No Workload Results were obtained from the run.
// Benchmark Process 1271779 has exited with code 255.

// ** Remained 24 (85.7%) benchmark(s) to run. Estimated finish 2026-01-27 23:49 (0h 30m from now) **
// **************************
// Benchmark: ProducerBenchmarks.'Dekaf: Fire-and-Forget Send': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=100, BatchSize=100]
// *** Execute ***
// Launch: 1 / 1
// Execute: dotnet 8d2c821d-2520-4124-9cd5-dd795016bb32.dll --anonymousPipes 126 127 --benchmarkName "Dekaf.Benchmarks.ProducerBenchmarks.FireAndForget_Dekaf(MessageSize: 100, BatchSize: 100)" --job "IterationCount=10, RunStrategy=Throughput, WarmupCount=3" --benchmarkId 4 in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/bin/Release/net10.0
// Failed to set up high priority (Permission denied). In order to run benchmarks with high priority, make sure you have the right permissions.
// BeforeAnythingElse

// Benchmark Process Environment Information:
// BenchmarkDotNet v0.14.0
// Runtime=.NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2
// GC=Concurrent Workstation
// HardwareIntrinsics=AVX2,AES,BMI1,BMI2,FMA,LZCNT,PCLMUL,POPCNT,AvxVnni,SERIALIZE VectorSize=256
// Job: Job-KZLKMS(IterationCount=10, RunStrategy=Throughput, WarmupCount=3)

Starting Kafka container via Testcontainers...
[testcontainers.org 00:00:00.08] Connected to Docker:
  Host: unix:///var/run/docker.sock
  Server Version: 29.2.0
  Kernel Version: 6.17.0-8-generic
  API Version: 1.53
  Operating System: Ubuntu 25.10
  Total Memory: 30.58 GB
[testcontainers.org 00:00:00.19] Docker container 917dc6b9c223 created
[testcontainers.org 00:00:00.21] Start Docker container 917dc6b9c223
[testcontainers.org 00:00:00.31] Wait for Docker container 917dc6b9c223 to complete readiness checks
[testcontainers.org 00:00:00.31] Docker container 917dc6b9c223 ready
[testcontainers.org 00:00:02.38] Docker container 86c6ea7be6ba created
[testcontainers.org 00:00:02.38] Start Docker container 86c6ea7be6ba
[testcontainers.org 00:00:02.51] Add file to tar archive: Content length: 390 byte(s), Target file: "/testcontainers.sh", UID: 0, GID: 0, Mode: 0755
[testcontainers.org 00:00:02.52] Copy tar archive to container: Content length: 390 byte(s), Docker container: 86c6ea7be6ba
[testcontainers.org 00:00:02.53] Wait for Docker container 86c6ea7be6ba to complete readiness checks
[testcontainers.org 00:00:05.57] Docker container 86c6ea7be6ba ready
Kafka started at plaintext://127.0.0.1:32786/
Waiting for Kafka to be ready...
Kafka is ready with 1 broker(s)
[testcontainers.org 00:00:05.80] Execute "kafka-topics --bootstrap-server localhost:9092 --create --topic benchmark-producer --partitions 3 --replication-factor 1" at Docker container 86c6ea7be6ba
Warning: Failed to create topic benchmark-producer: [2026-01-27 23:19:04,233] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:04,290] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:04,386] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:04,587] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:05,044] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:05,738] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:06,645] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:07,769] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:08,758] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:09,786] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:10,695] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:11,805] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:12,827] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:13,850] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:14,779] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:15,804] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:16,798] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:17,692] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:18,585] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:19,776] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:20,699] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:21,601] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:22,683] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:23,818] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:24,885] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:25,828] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:26,679] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:27,830] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:28,917] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:29,875] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:31,032] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:31,893] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:32,791] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:33,615] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:34,525] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:35,697] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:36,740] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:37,933] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:38,739] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:39,760] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:40,608] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:41,694] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:42,642] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:43,754] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:44,623] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:45,596] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:46,630] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:47,588] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:48,769] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:49,699] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:50,833] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:51,662] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:52,499] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:53,361] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:54,303] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:55,203] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:56,021] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:57,005] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:58,020] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:19:59,011] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:00,173] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:01,274] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:02,245] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:03,105] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32786) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:04,119] ERROR org.apache.kafka.common.errors.TimeoutException: Timed out waiting for a node assignment. Call: createTopics
 (kafka.admin.TopicCommand$)

System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.
 ---> System.InvalidOperationException: Failed to refresh metadata from any broker
   at Dekaf.Metadata.MetadataManager.RefreshMetadataInternalAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 278
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 218
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 204
   at Dekaf.Metadata.MetadataManager.InitializeAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 105
   at Dekaf.Producer.KafkaProducer`2.ProduceInternalAsync(ProducerMessage`2 message, PooledValueTaskSource`1 completion, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 970
   at Dekaf.Producer.KafkaProducer`2.ProcessWorkAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 950
   at Dekaf.Producer.PooledValueTaskSource`1.System.Threading.Tasks.Sources.IValueTaskSource<T>.GetResult(Int16 token) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/PooledValueTaskSource.cs:line 145
   at Dekaf.Producer.KafkaProducer`2.ProduceAsyncSlow(ProducerMessage`2 message, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 287
   at Dekaf.Benchmarks.ProducerBenchmarks.WarmupAsync() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 67
   at Dekaf.Benchmarks.ProducerBenchmarks.Setup() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 59
   at BenchmarkDotNet.Helpers.AwaitHelper.GetResult(Task task)
   at BenchmarkDotNet.Autogenerated.Runnable_4.<.ctor>b__3_0() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 879
   at BenchmarkDotNet.Engines.EngineFactory.CreateReadyToRun(EngineParameters engineParameters)
   at BenchmarkDotNet.Autogenerated.Runnable_4.Run(IHost host, String benchmarkName) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 863
   at System.Reflection.MethodBaseInvoker.InterpretedInvoke_Method(Object obj, IntPtr* args)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   --- End of inner exception stack trace ---
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at BenchmarkDotNet.Autogenerated.UniqueProgramName.AfterAssemblyLoadingAttached(String[] args) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 57
// AfterAll
No Workload Results were obtained from the run.
// Benchmark Process 1278643 has exited with code 255.

// ** Remained 23 (82.1%) benchmark(s) to run. Estimated finish 2026-01-27 23:48 (0h 28m from now) **
// **************************
// Benchmark: ProducerBenchmarks.'Dekaf: Fire-and-Forget Direct': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=100, BatchSize=100]
// *** Execute ***
// Launch: 1 / 1
// Execute: dotnet 8d2c821d-2520-4124-9cd5-dd795016bb32.dll --anonymousPipes 126 127 --benchmarkName "Dekaf.Benchmarks.ProducerBenchmarks.FireAndForget_Dekaf_Direct(MessageSize: 100, BatchSize: 100)" --job "IterationCount=10, RunStrategy=Throughput, WarmupCount=3" --benchmarkId 5 in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/bin/Release/net10.0
// Failed to set up high priority (Permission denied). In order to run benchmarks with high priority, make sure you have the right permissions.
// BeforeAnythingElse

// Benchmark Process Environment Information:
// BenchmarkDotNet v0.14.0
// Runtime=.NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2
// GC=Concurrent Workstation
// HardwareIntrinsics=AVX2,AES,BMI1,BMI2,FMA,LZCNT,PCLMUL,POPCNT,AvxVnni,SERIALIZE VectorSize=256
// Job: Job-URDQAW(IterationCount=10, RunStrategy=Throughput, WarmupCount=3)

Starting Kafka container via Testcontainers...
[testcontainers.org 00:00:00.09] Connected to Docker:
  Host: unix:///var/run/docker.sock
  Server Version: 29.2.0
  Kernel Version: 6.17.0-8-generic
  API Version: 1.53
  Operating System: Ubuntu 25.10
  Total Memory: 30.58 GB
[testcontainers.org 00:00:00.19] Docker container d27df569e772 created
[testcontainers.org 00:00:00.21] Start Docker container d27df569e772
[testcontainers.org 00:00:00.31] Wait for Docker container d27df569e772 to complete readiness checks
[testcontainers.org 00:00:00.31] Docker container d27df569e772 ready
[testcontainers.org 00:00:02.37] Docker container 3f1caf01644d created
[testcontainers.org 00:00:02.37] Start Docker container 3f1caf01644d
[testcontainers.org 00:00:02.48] Add file to tar archive: Content length: 390 byte(s), Target file: "/testcontainers.sh", UID: 0, GID: 0, Mode: 0755
[testcontainers.org 00:00:02.49] Copy tar archive to container: Content length: 390 byte(s), Docker container: 3f1caf01644d
[testcontainers.org 00:00:02.49] Wait for Docker container 3f1caf01644d to complete readiness checks
[testcontainers.org 00:00:05.53] Docker container 3f1caf01644d ready
Kafka started at plaintext://127.0.0.1:32790/
Waiting for Kafka to be ready...
Kafka is ready with 1 broker(s)
[testcontainers.org 00:00:05.77] Execute "kafka-topics --bootstrap-server localhost:9092 --create --topic benchmark-producer --partitions 3 --replication-factor 1" at Docker container 3f1caf01644d
Warning: Failed to create topic benchmark-producer: [2026-01-27 23:20:10,976] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:11,020] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:11,105] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:11,286] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:11,717] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:12,455] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:13,356] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:14,270] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:15,163] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:16,253] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:17,149] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:18,080] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:18,962] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:19,972] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:20,779] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:21,631] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:22,538] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:23,345] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:24,184] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:25,055] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:26,152] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:26,982] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:27,915] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:28,884] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:29,799] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:30,749] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:31,872] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:32,818] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:33,958] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:34,856] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:35,873] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:36,685] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:37,488] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:38,437] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:39,268] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:40,114] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:41,024] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:42,165] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:43,065] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:44,263] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:45,298] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:46,422] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:47,337] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:48,231] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:49,246] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:50,313] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:51,258] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:52,072] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:53,034] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:54,043] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:55,140] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:55,969] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:56,942] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:57,988] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:20:59,120] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:00,182] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:01,092] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:02,258] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:03,272] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:04,253] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:05,407] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:06,338] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:07,537] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:08,444] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:09,617] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:10,427] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32790) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:10,867] ERROR org.apache.kafka.common.errors.TimeoutException: Timed out waiting for a node assignment. Call: createTopics
 (kafka.admin.TopicCommand$)

System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.
 ---> System.InvalidOperationException: Failed to refresh metadata from any broker
   at Dekaf.Metadata.MetadataManager.RefreshMetadataInternalAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 278
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 218
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 204
   at Dekaf.Metadata.MetadataManager.InitializeAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 105
   at Dekaf.Producer.KafkaProducer`2.ProduceInternalAsync(ProducerMessage`2 message, PooledValueTaskSource`1 completion, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 970
   at Dekaf.Producer.KafkaProducer`2.ProcessWorkAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 950
   at Dekaf.Producer.PooledValueTaskSource`1.System.Threading.Tasks.Sources.IValueTaskSource<T>.GetResult(Int16 token) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/PooledValueTaskSource.cs:line 145
   at Dekaf.Producer.KafkaProducer`2.ProduceAsyncSlow(ProducerMessage`2 message, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 287
   at Dekaf.Benchmarks.ProducerBenchmarks.WarmupAsync() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 67
   at Dekaf.Benchmarks.ProducerBenchmarks.Setup() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 59
   at BenchmarkDotNet.Helpers.AwaitHelper.GetResult(Task task)
   at BenchmarkDotNet.Autogenerated.Runnable_5.<.ctor>b__3_0() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 1073
   at BenchmarkDotNet.Engines.EngineFactory.CreateReadyToRun(EngineParameters engineParameters)
   at BenchmarkDotNet.Autogenerated.Runnable_5.Run(IHost host, String benchmarkName) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 1057
   at System.Reflection.MethodBaseInvoker.InterpretedInvoke_Method(Object obj, IntPtr* args)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   --- End of inner exception stack trace ---
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at BenchmarkDotNet.Autogenerated.UniqueProgramName.AfterAssemblyLoadingAttached(String[] args) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 57
// AfterAll
No Workload Results were obtained from the run.
// Benchmark Process 1285531 has exited with code 255.

// ** Remained 22 (78.6%) benchmark(s) to run. Estimated finish 2026-01-27 23:47 (0h 26m from now) **
// **************************
// Benchmark: ProducerBenchmarks.'Confluent: Fire-and-Forget Produce': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=100, BatchSize=100]
// *** Execute ***
// Launch: 1 / 1
// Execute: dotnet 8d2c821d-2520-4124-9cd5-dd795016bb32.dll --anonymousPipes 126 127 --benchmarkName "Dekaf.Benchmarks.ProducerBenchmarks.FireAndForget_Confluent(MessageSize: 100, BatchSize: 100)" --job "IterationCount=10, RunStrategy=Throughput, WarmupCount=3" --benchmarkId 6 in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/bin/Release/net10.0
// Failed to set up high priority (Permission denied). In order to run benchmarks with high priority, make sure you have the right permissions.
// BeforeAnythingElse

// Benchmark Process Environment Information:
// BenchmarkDotNet v0.14.0
// Runtime=.NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2
// GC=Concurrent Workstation
// HardwareIntrinsics=AVX2,AES,BMI1,BMI2,FMA,LZCNT,PCLMUL,POPCNT,AvxVnni,SERIALIZE VectorSize=256
// Job: Job-BRMZJC(IterationCount=10, RunStrategy=Throughput, WarmupCount=3)

Starting Kafka container via Testcontainers...
[testcontainers.org 00:00:00.08] Connected to Docker:
  Host: unix:///var/run/docker.sock
  Server Version: 29.2.0
  Kernel Version: 6.17.0-8-generic
  API Version: 1.53
  Operating System: Ubuntu 25.10
  Total Memory: 30.58 GB
[testcontainers.org 00:00:00.18] Docker container b1a1f10cc697 created
[testcontainers.org 00:00:00.20] Start Docker container b1a1f10cc697
[testcontainers.org 00:00:00.31] Wait for Docker container b1a1f10cc697 to complete readiness checks
[testcontainers.org 00:00:00.31] Docker container b1a1f10cc697 ready
[testcontainers.org 00:00:02.38] Docker container 995bd6631c08 created
[testcontainers.org 00:00:02.38] Start Docker container 995bd6631c08
[testcontainers.org 00:00:02.50] Add file to tar archive: Content length: 390 byte(s), Target file: "/testcontainers.sh", UID: 0, GID: 0, Mode: 0755
[testcontainers.org 00:00:02.51] Copy tar archive to container: Content length: 390 byte(s), Docker container: 995bd6631c08
[testcontainers.org 00:00:02.51] Wait for Docker container 995bd6631c08 to complete readiness checks
[testcontainers.org 00:00:05.55] Docker container 995bd6631c08 ready
Kafka started at plaintext://127.0.0.1:32794/
Waiting for Kafka to be ready...
Kafka is ready with 1 broker(s)
[testcontainers.org 00:00:05.79] Execute "kafka-topics --bootstrap-server localhost:9092 --create --topic benchmark-producer --partitions 3 --replication-factor 1" at Docker container 995bd6631c08
Warning: Failed to create topic benchmark-producer: [2026-01-27 23:21:17,749] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:17,801] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:17,892] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:18,095] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:18,505] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:19,273] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:20,247] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:21,240] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:22,298] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:23,392] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:24,532] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:25,452] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:26,489] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:27,483] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:28,525] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:29,584] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:30,566] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:31,588] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:32,527] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:33,586] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:34,478] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:35,672] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:36,684] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:37,716] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:38,776] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:39,680] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:40,607] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:41,568] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:42,530] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:43,720] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:44,594] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:45,621] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:46,572] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:47,538] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:48,691] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:49,594] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:50,748] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:51,644] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:52,675] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:53,734] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:54,721] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:55,777] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:56,603] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:57,654] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:58,694] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:21:59,768] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:00,775] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:01,747] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:02,599] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:03,633] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:04,516] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:05,506] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:06,401] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:07,535] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:08,500] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:09,446] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:10,601] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:11,653] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:12,617] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:13,442] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:14,463] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:15,406] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:16,291] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:17,457] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32794) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:17,633] ERROR org.apache.kafka.common.errors.TimeoutException: Timed out waiting for a node assignment. Call: createTopics
 (kafka.admin.TopicCommand$)

System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.
 ---> System.InvalidOperationException: Failed to refresh metadata from any broker
   at Dekaf.Metadata.MetadataManager.RefreshMetadataInternalAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 278
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 218
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 204
   at Dekaf.Metadata.MetadataManager.InitializeAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 105
   at Dekaf.Producer.KafkaProducer`2.ProduceInternalAsync(ProducerMessage`2 message, PooledValueTaskSource`1 completion, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 970
   at Dekaf.Producer.KafkaProducer`2.ProcessWorkAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 950
   at Dekaf.Producer.PooledValueTaskSource`1.System.Threading.Tasks.Sources.IValueTaskSource<T>.GetResult(Int16 token) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/PooledValueTaskSource.cs:line 145
   at Dekaf.Producer.KafkaProducer`2.ProduceAsyncSlow(ProducerMessage`2 message, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 287
   at Dekaf.Benchmarks.ProducerBenchmarks.WarmupAsync() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 67
   at Dekaf.Benchmarks.ProducerBenchmarks.Setup() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 59
   at BenchmarkDotNet.Helpers.AwaitHelper.GetResult(Task task)
   at BenchmarkDotNet.Autogenerated.Runnable_6.<.ctor>b__3_0() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 1267
   at BenchmarkDotNet.Engines.EngineFactory.CreateReadyToRun(EngineParameters engineParameters)
   at BenchmarkDotNet.Autogenerated.Runnable_6.Run(IHost host, String benchmarkName) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 1251
   at System.Reflection.MethodBaseInvoker.InterpretedInvoke_Method(Object obj, IntPtr* args)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   --- End of inner exception stack trace ---
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at BenchmarkDotNet.Autogenerated.UniqueProgramName.AfterAssemblyLoadingAttached(String[] args) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 57
// AfterAll
No Workload Results were obtained from the run.
// Benchmark Process 1292422 has exited with code 255.

// ** Remained 21 (75.0%) benchmark(s) to run. Estimated finish 2026-01-27 23:47 (0h 25m from now) **
// **************************
// Benchmark: ProducerBenchmarks.'Dekaf: Single Message Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=100, BatchSize=1000]
// *** Execute ***
// Launch: 1 / 1
// Execute: dotnet 8d2c821d-2520-4124-9cd5-dd795016bb32.dll --anonymousPipes 126 127 --benchmarkName "Dekaf.Benchmarks.ProducerBenchmarks.SingleProduce_Dekaf(MessageSize: 100, BatchSize: 1000)" --job "InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3" --benchmarkId 7 in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/bin/Release/net10.0
// Failed to set up high priority (Permission denied). In order to run benchmarks with high priority, make sure you have the right permissions.
// BeforeAnythingElse

// Benchmark Process Environment Information:
// BenchmarkDotNet v0.14.0
// Runtime=.NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2
// GC=Concurrent Workstation
// HardwareIntrinsics=AVX2,AES,BMI1,BMI2,FMA,LZCNT,PCLMUL,POPCNT,AvxVnni,SERIALIZE VectorSize=256
// Job: Job-HIBGFG(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3)

Starting Kafka container via Testcontainers...
[testcontainers.org 00:00:00.08] Connected to Docker:
  Host: unix:///var/run/docker.sock
  Server Version: 29.2.0
  Kernel Version: 6.17.0-8-generic
  API Version: 1.53
  Operating System: Ubuntu 25.10
  Total Memory: 30.58 GB
[testcontainers.org 00:00:00.18] Docker container 2f08fb465ebb created
[testcontainers.org 00:00:00.21] Start Docker container 2f08fb465ebb
[testcontainers.org 00:00:00.33] Wait for Docker container 2f08fb465ebb to complete readiness checks
[testcontainers.org 00:00:00.33] Docker container 2f08fb465ebb ready
[testcontainers.org 00:00:02.40] Docker container 4db04abe0ede created
[testcontainers.org 00:00:02.40] Start Docker container 4db04abe0ede
[testcontainers.org 00:00:02.51] Add file to tar archive: Content length: 390 byte(s), Target file: "/testcontainers.sh", UID: 0, GID: 0, Mode: 0755
[testcontainers.org 00:00:02.52] Copy tar archive to container: Content length: 390 byte(s), Docker container: 4db04abe0ede
[testcontainers.org 00:00:02.53] Wait for Docker container 4db04abe0ede to complete readiness checks
[testcontainers.org 00:00:05.56] Docker container 4db04abe0ede ready
Kafka started at plaintext://127.0.0.1:32798/
Waiting for Kafka to be ready...
Kafka is ready with 1 broker(s)
[testcontainers.org 00:00:05.80] Execute "kafka-topics --bootstrap-server localhost:9092 --create --topic benchmark-producer --partitions 3 --replication-factor 1" at Docker container 4db04abe0ede
Warning: Failed to create topic benchmark-producer: [2026-01-27 23:22:24,541] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:24,591] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:24,684] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:24,924] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:25,273] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:26,129] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:27,098] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:28,130] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:29,006] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:30,073] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:31,188] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:32,357] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:33,388] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:34,418] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:35,386] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:36,463] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:37,465] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:38,463] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:39,602] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:40,765] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:41,891] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:42,949] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:43,891] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:44,857] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:45,823] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:46,769] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:47,959] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:48,897] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:50,082] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:51,017] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:51,933] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:52,887] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:54,002] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:55,111] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:56,131] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:57,086] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:58,184] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:22:59,251] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:00,405] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:01,232] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:02,336] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:03,205] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:04,392] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:05,254] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:06,148] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:07,254] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:08,076] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:08,964] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:10,056] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:11,191] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:12,231] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:13,093] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:13,978] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:15,176] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:16,262] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:17,238] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:18,124] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:19,282] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:20,320] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:21,329] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:22,134] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:23,170] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:24,152] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32798) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:24,432] ERROR org.apache.kafka.common.errors.TimeoutException: Timed out waiting for a node assignment. Call: createTopics
 (kafka.admin.TopicCommand$)

System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.
 ---> System.InvalidOperationException: Failed to refresh metadata from any broker
   at Dekaf.Metadata.MetadataManager.RefreshMetadataInternalAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 278
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 218
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 204
   at Dekaf.Metadata.MetadataManager.InitializeAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 105
   at Dekaf.Producer.KafkaProducer`2.ProduceInternalAsync(ProducerMessage`2 message, PooledValueTaskSource`1 completion, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 970
   at Dekaf.Producer.KafkaProducer`2.ProcessWorkAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 950
   at Dekaf.Producer.PooledValueTaskSource`1.System.Threading.Tasks.Sources.IValueTaskSource<T>.GetResult(Int16 token) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/PooledValueTaskSource.cs:line 145
   at Dekaf.Producer.KafkaProducer`2.ProduceAsyncSlow(ProducerMessage`2 message, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 287
   at Dekaf.Benchmarks.ProducerBenchmarks.WarmupAsync() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 67
   at Dekaf.Benchmarks.ProducerBenchmarks.Setup() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 59
   at BenchmarkDotNet.Helpers.AwaitHelper.GetResult(Task task)
   at BenchmarkDotNet.Autogenerated.Runnable_7.<.ctor>b__3_0() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 1463
   at BenchmarkDotNet.Engines.EngineFactory.CreateReadyToRun(EngineParameters engineParameters)
   at BenchmarkDotNet.Autogenerated.Runnable_7.Run(IHost host, String benchmarkName) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 1447
   at System.Reflection.MethodBaseInvoker.InterpretedInvoke_Method(Object obj, IntPtr* args)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   --- End of inner exception stack trace ---
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at BenchmarkDotNet.Autogenerated.UniqueProgramName.AfterAssemblyLoadingAttached(String[] args) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 57
// AfterAll
No Workload Results were obtained from the run.
// Benchmark Process 1299264 has exited with code 255.

// ** Remained 20 (71.4%) benchmark(s) to run. Estimated finish 2026-01-27 23:47 (0h 23m from now) **
// **************************
// Benchmark: ProducerBenchmarks.'Confluent: Single Message Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=100, BatchSize=1000]
// *** Execute ***
// Launch: 1 / 1
// Execute: dotnet 8d2c821d-2520-4124-9cd5-dd795016bb32.dll --anonymousPipes 117 126 --benchmarkName "Dekaf.Benchmarks.ProducerBenchmarks.SingleProduce_Confluent(MessageSize: 100, BatchSize: 1000)" --job "InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3" --benchmarkId 8 in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/bin/Release/net10.0
// Failed to set up high priority (Permission denied). In order to run benchmarks with high priority, make sure you have the right permissions.
// BeforeAnythingElse

// Benchmark Process Environment Information:
// BenchmarkDotNet v0.14.0
// Runtime=.NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2
// GC=Concurrent Workstation
// HardwareIntrinsics=AVX2,AES,BMI1,BMI2,FMA,LZCNT,PCLMUL,POPCNT,AvxVnni,SERIALIZE VectorSize=256
// Job: Job-TOAFWZ(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3)

Starting Kafka container via Testcontainers...
[testcontainers.org 00:00:00.08] Connected to Docker:
  Host: unix:///var/run/docker.sock
  Server Version: 29.2.0
  Kernel Version: 6.17.0-8-generic
  API Version: 1.53
  Operating System: Ubuntu 25.10
  Total Memory: 30.58 GB
[testcontainers.org 00:00:00.20] Docker container 6693f7fda7b7 created
[testcontainers.org 00:00:00.22] Start Docker container 6693f7fda7b7
[testcontainers.org 00:00:00.34] Wait for Docker container 6693f7fda7b7 to complete readiness checks
[testcontainers.org 00:00:00.34] Docker container 6693f7fda7b7 ready
[testcontainers.org 00:00:02.41] Docker container 15a836e244b6 created
[testcontainers.org 00:00:02.41] Start Docker container 15a836e244b6
[testcontainers.org 00:00:02.54] Add file to tar archive: Content length: 390 byte(s), Target file: "/testcontainers.sh", UID: 0, GID: 0, Mode: 0755
[testcontainers.org 00:00:02.55] Copy tar archive to container: Content length: 390 byte(s), Docker container: 15a836e244b6
[testcontainers.org 00:00:02.56] Wait for Docker container 15a836e244b6 to complete readiness checks
[testcontainers.org 00:00:05.61] Docker container 15a836e244b6 ready
Kafka started at plaintext://127.0.0.1:32802/
Waiting for Kafka to be ready...
Kafka is ready with 1 broker(s)
[testcontainers.org 00:00:05.85] Execute "kafka-topics --bootstrap-server localhost:9092 --create --topic benchmark-producer --partitions 3 --replication-factor 1" at Docker container 15a836e244b6
Warning: Failed to create topic benchmark-producer: [2026-01-27 23:23:31,382] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:31,422] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:31,508] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:31,694] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:32,156] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:32,814] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:33,834] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:34,657] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:35,591] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:36,599] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:37,424] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:38,348] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:39,482] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:40,468] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:41,607] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:42,518] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:43,487] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:44,434] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:45,405] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:46,320] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:47,380] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:48,314] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:49,460] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:50,340] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:51,459] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:52,323] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:53,487] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:54,397] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:55,329] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:56,487] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:57,381] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:58,509] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:23:59,489] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:00,687] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:01,711] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:02,712] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:03,733] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:04,651] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:05,671] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:06,646] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:07,732] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:08,727] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:09,547] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:10,644] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:11,752] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:12,942] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:13,917] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:14,949] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:15,893] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:16,813] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:17,742] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:18,721] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:19,701] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:20,785] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:21,943] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:22,947] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:24,138] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:25,313] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:26,194] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:27,330] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:28,478] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:29,287] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:30,426] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32802) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:31,269] ERROR org.apache.kafka.common.errors.TimeoutException: Timed out waiting for a node assignment. Call: createTopics
 (kafka.admin.TopicCommand$)

System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.
 ---> System.InvalidOperationException: Failed to refresh metadata from any broker
   at Dekaf.Metadata.MetadataManager.RefreshMetadataInternalAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 278
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 218
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 204
   at Dekaf.Metadata.MetadataManager.InitializeAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 105
   at Dekaf.Producer.KafkaProducer`2.ProduceInternalAsync(ProducerMessage`2 message, PooledValueTaskSource`1 completion, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 970
   at Dekaf.Producer.KafkaProducer`2.ProcessWorkAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 950
   at Dekaf.Producer.PooledValueTaskSource`1.System.Threading.Tasks.Sources.IValueTaskSource<T>.GetResult(Int16 token) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/PooledValueTaskSource.cs:line 145
   at Dekaf.Producer.KafkaProducer`2.ProduceAsyncSlow(ProducerMessage`2 message, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 287
   at Dekaf.Benchmarks.ProducerBenchmarks.WarmupAsync() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 67
   at Dekaf.Benchmarks.ProducerBenchmarks.Setup() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 59
   at BenchmarkDotNet.Helpers.AwaitHelper.GetResult(Task task)
   at BenchmarkDotNet.Autogenerated.Runnable_8.<.ctor>b__3_0() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 1645
   at BenchmarkDotNet.Engines.EngineFactory.CreateReadyToRun(EngineParameters engineParameters)
   at BenchmarkDotNet.Autogenerated.Runnable_8.Run(IHost host, String benchmarkName) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 1629
   at System.Reflection.MethodBaseInvoker.InterpretedInvoke_Method(Object obj, IntPtr* args)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   --- End of inner exception stack trace ---
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at BenchmarkDotNet.Autogenerated.UniqueProgramName.AfterAssemblyLoadingAttached(String[] args) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 57
// AfterAll
No Workload Results were obtained from the run.
// Benchmark Process 1306153 has exited with code 255.

// ** Remained 19 (67.9%) benchmark(s) to run. Estimated finish 2026-01-27 23:46 (0h 22m from now) **
// **************************
// Benchmark: ProducerBenchmarks.'Dekaf: Batch Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=100, BatchSize=1000]
// *** Execute ***
// Launch: 1 / 1
// Execute: dotnet 8d2c821d-2520-4124-9cd5-dd795016bb32.dll --anonymousPipes 127 128 --benchmarkName "Dekaf.Benchmarks.ProducerBenchmarks.BatchProduce_Dekaf(MessageSize: 100, BatchSize: 1000)" --job "InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3" --benchmarkId 9 in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/bin/Release/net10.0
// Failed to set up high priority (Permission denied). In order to run benchmarks with high priority, make sure you have the right permissions.
// BeforeAnythingElse

// Benchmark Process Environment Information:
// BenchmarkDotNet v0.14.0
// Runtime=.NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2
// GC=Concurrent Workstation
// HardwareIntrinsics=AVX2,AES,BMI1,BMI2,FMA,LZCNT,PCLMUL,POPCNT,AvxVnni,SERIALIZE VectorSize=256
// Job: Job-VCSFBS(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3)

Starting Kafka container via Testcontainers...
[testcontainers.org 00:00:00.09] Connected to Docker:
  Host: unix:///var/run/docker.sock
  Server Version: 29.2.0
  Kernel Version: 6.17.0-8-generic
  API Version: 1.53
  Operating System: Ubuntu 25.10
  Total Memory: 30.58 GB
[testcontainers.org 00:00:00.19] Docker container cf9957d5381f created
[testcontainers.org 00:00:00.22] Start Docker container cf9957d5381f
[testcontainers.org 00:00:00.32] Wait for Docker container cf9957d5381f to complete readiness checks
[testcontainers.org 00:00:00.32] Docker container cf9957d5381f ready
[testcontainers.org 00:00:02.40] Docker container f5ffe2b0b63c created
[testcontainers.org 00:00:02.40] Start Docker container f5ffe2b0b63c
[testcontainers.org 00:00:02.52] Add file to tar archive: Content length: 390 byte(s), Target file: "/testcontainers.sh", UID: 0, GID: 0, Mode: 0755
[testcontainers.org 00:00:02.53] Copy tar archive to container: Content length: 390 byte(s), Docker container: f5ffe2b0b63c
[testcontainers.org 00:00:02.53] Wait for Docker container f5ffe2b0b63c to complete readiness checks
[testcontainers.org 00:00:05.57] Docker container f5ffe2b0b63c ready
Kafka started at plaintext://127.0.0.1:32806/
Waiting for Kafka to be ready...
Kafka is ready with 1 broker(s)
[testcontainers.org 00:00:05.81] Execute "kafka-topics --bootstrap-server localhost:9092 --create --topic benchmark-producer --partitions 3 --replication-factor 1" at Docker container f5ffe2b0b63c
Warning: Failed to create topic benchmark-producer: [2026-01-27 23:24:38,159] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:38,202] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:38,285] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:38,447] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:38,801] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:39,546] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:40,647] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:41,522] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:42,721] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:43,555] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:44,694] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:45,565] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:46,424] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:47,534] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:48,498] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:49,407] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:50,454] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:51,558] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:52,678] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:53,777] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:54,850] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:55,670] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:56,549] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:57,438] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:58,636] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:24:59,757] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:00,882] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:01,968] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:03,107] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:04,158] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:05,158] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:06,324] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:07,466] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:08,409] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:09,406] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:10,214] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:11,204] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:12,009] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:12,940] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:13,956] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:14,974] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:15,905] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:17,016] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:17,910] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:18,752] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:19,566] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:20,380] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:21,556] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:22,364] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:23,409] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:24,364] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:25,182] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:26,312] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:27,141] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:28,031] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:29,213] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:30,174] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:31,026] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:32,032] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:32,834] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:33,738] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:34,931] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:35,824] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:36,654] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:37,751] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32806) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:38,046] ERROR org.apache.kafka.common.errors.TimeoutException: Timed out waiting for a node assignment. Call: createTopics
 (kafka.admin.TopicCommand$)

System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.
 ---> System.InvalidOperationException: Failed to refresh metadata from any broker
   at Dekaf.Metadata.MetadataManager.RefreshMetadataInternalAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 278
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 218
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 204
   at Dekaf.Metadata.MetadataManager.InitializeAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 105
   at Dekaf.Producer.KafkaProducer`2.ProduceInternalAsync(ProducerMessage`2 message, PooledValueTaskSource`1 completion, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 970
   at Dekaf.Producer.KafkaProducer`2.ProcessWorkAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 950
   at Dekaf.Producer.PooledValueTaskSource`1.System.Threading.Tasks.Sources.IValueTaskSource<T>.GetResult(Int16 token) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/PooledValueTaskSource.cs:line 145
   at Dekaf.Producer.KafkaProducer`2.ProduceAsyncSlow(ProducerMessage`2 message, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 287
   at Dekaf.Benchmarks.ProducerBenchmarks.WarmupAsync() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 67
   at Dekaf.Benchmarks.ProducerBenchmarks.Setup() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 59
   at BenchmarkDotNet.Helpers.AwaitHelper.GetResult(Task task)
   at BenchmarkDotNet.Autogenerated.Runnable_9.<.ctor>b__3_0() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 1816
   at BenchmarkDotNet.Engines.EngineFactory.CreateReadyToRun(EngineParameters engineParameters)
   at BenchmarkDotNet.Autogenerated.Runnable_9.Run(IHost host, String benchmarkName) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 1800
   at System.Reflection.MethodBaseInvoker.InterpretedInvoke_Method(Object obj, IntPtr* args)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   --- End of inner exception stack trace ---
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at BenchmarkDotNet.Autogenerated.UniqueProgramName.AfterAssemblyLoadingAttached(String[] args) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 57
// AfterAll
No Workload Results were obtained from the run.
// Benchmark Process 1313016 has exited with code 255.

// ** Remained 18 (64.3%) benchmark(s) to run. Estimated finish 2026-01-27 23:46 (0h 21m from now) **
// **************************
// Benchmark: ProducerBenchmarks.'Confluent: Batch Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=100, BatchSize=1000]
// *** Execute ***
// Launch: 1 / 1
// Execute: dotnet 8d2c821d-2520-4124-9cd5-dd795016bb32.dll --anonymousPipes 127 128 --benchmarkName "Dekaf.Benchmarks.ProducerBenchmarks.BatchProduce_Confluent(MessageSize: 100, BatchSize: 1000)" --job "InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3" --benchmarkId 10 in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/bin/Release/net10.0
// Failed to set up high priority (Permission denied). In order to run benchmarks with high priority, make sure you have the right permissions.
// BeforeAnythingElse

// Benchmark Process Environment Information:
// BenchmarkDotNet v0.14.0
// Runtime=.NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2
// GC=Concurrent Workstation
// HardwareIntrinsics=AVX2,AES,BMI1,BMI2,FMA,LZCNT,PCLMUL,POPCNT,AvxVnni,SERIALIZE VectorSize=256
// Job: Job-YUKULZ(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3)

Starting Kafka container via Testcontainers...
[testcontainers.org 00:00:00.08] Connected to Docker:
  Host: unix:///var/run/docker.sock
  Server Version: 29.2.0
  Kernel Version: 6.17.0-8-generic
  API Version: 1.53
  Operating System: Ubuntu 25.10
  Total Memory: 30.58 GB
[testcontainers.org 00:00:00.19] Docker container 875581001f85 created
[testcontainers.org 00:00:00.21] Start Docker container 875581001f85
[testcontainers.org 00:00:00.33] Wait for Docker container 875581001f85 to complete readiness checks
[testcontainers.org 00:00:00.33] Docker container 875581001f85 ready
[testcontainers.org 00:00:02.41] Docker container 699a484f1fd9 created
[testcontainers.org 00:00:02.41] Start Docker container 699a484f1fd9
[testcontainers.org 00:00:02.53] Add file to tar archive: Content length: 390 byte(s), Target file: "/testcontainers.sh", UID: 0, GID: 0, Mode: 0755
[testcontainers.org 00:00:02.54] Copy tar archive to container: Content length: 390 byte(s), Docker container: 699a484f1fd9
[testcontainers.org 00:00:02.54] Wait for Docker container 699a484f1fd9 to complete readiness checks
[testcontainers.org 00:00:05.58] Docker container 699a484f1fd9 ready
Kafka started at plaintext://127.0.0.1:32810/
Waiting for Kafka to be ready...
Kafka is ready with 1 broker(s)
[testcontainers.org 00:00:05.82] Execute "kafka-topics --bootstrap-server localhost:9092 --create --topic benchmark-producer --partitions 3 --replication-factor 1" at Docker container 699a484f1fd9
Warning: Failed to create topic benchmark-producer: [2026-01-27 23:25:44,998] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:45,042] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:45,139] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:45,367] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:45,741] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:46,424] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:47,598] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:48,502] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:49,563] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:50,593] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:51,597] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:52,560] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:53,695] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:54,643] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:55,780] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:56,675] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:57,759] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:58,694] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:25:59,598] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:00,567] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:01,673] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:02,524] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:03,614] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:04,542] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:05,530] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:06,718] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:07,677] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:08,561] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:09,448] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:10,566] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:11,676] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:12,851] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:13,758] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:14,754] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:15,750] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:16,709] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:17,812] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:18,978] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:20,072] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:21,246] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:22,215] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:23,319] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:24,490] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:25,404] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:26,416] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:27,265] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:28,128] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:29,097] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:30,265] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:31,091] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:32,018] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:33,121] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:34,321] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:35,312] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:36,160] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:37,173] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:38,077] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:39,268] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:40,175] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:41,124] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:41,962] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:42,995] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:44,168] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32810) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:44,888] ERROR org.apache.kafka.common.errors.TimeoutException: Timed out waiting for a node assignment. Call: createTopics
 (kafka.admin.TopicCommand$)

System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.
 ---> System.InvalidOperationException: Failed to refresh metadata from any broker
   at Dekaf.Metadata.MetadataManager.RefreshMetadataInternalAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 278
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 218
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 204
   at Dekaf.Metadata.MetadataManager.InitializeAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 105
   at Dekaf.Producer.KafkaProducer`2.ProduceInternalAsync(ProducerMessage`2 message, PooledValueTaskSource`1 completion, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 970
   at Dekaf.Producer.KafkaProducer`2.ProcessWorkAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 950
   at Dekaf.Producer.PooledValueTaskSource`1.System.Threading.Tasks.Sources.IValueTaskSource<T>.GetResult(Int16 token) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/PooledValueTaskSource.cs:line 145
   at Dekaf.Producer.KafkaProducer`2.ProduceAsyncSlow(ProducerMessage`2 message, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 287
   at Dekaf.Benchmarks.ProducerBenchmarks.WarmupAsync() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 67
   at Dekaf.Benchmarks.ProducerBenchmarks.Setup() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 59
   at BenchmarkDotNet.Helpers.AwaitHelper.GetResult(Task task)
   at BenchmarkDotNet.Autogenerated.Runnable_10.<.ctor>b__3_0() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 1982
   at BenchmarkDotNet.Engines.EngineFactory.CreateReadyToRun(EngineParameters engineParameters)
   at BenchmarkDotNet.Autogenerated.Runnable_10.Run(IHost host, String benchmarkName) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 1966
   at System.Reflection.MethodBaseInvoker.InterpretedInvoke_Method(Object obj, IntPtr* args)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   --- End of inner exception stack trace ---
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at BenchmarkDotNet.Autogenerated.UniqueProgramName.AfterAssemblyLoadingAttached(String[] args) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 57
// AfterAll
No Workload Results were obtained from the run.
// Benchmark Process 1319806 has exited with code 255.

// ** Remained 17 (60.7%) benchmark(s) to run. Estimated finish 2026-01-27 23:46 (0h 19m from now) **
// **************************
// Benchmark: ProducerBenchmarks.'Dekaf: Fire-and-Forget Send': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=100, BatchSize=1000]
// *** Execute ***
// Launch: 1 / 1
// Execute: dotnet 8d2c821d-2520-4124-9cd5-dd795016bb32.dll --anonymousPipes 127 128 --benchmarkName "Dekaf.Benchmarks.ProducerBenchmarks.FireAndForget_Dekaf(MessageSize: 100, BatchSize: 1000)" --job "IterationCount=10, RunStrategy=Throughput, WarmupCount=3" --benchmarkId 11 in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/bin/Release/net10.0
// Failed to set up high priority (Permission denied). In order to run benchmarks with high priority, make sure you have the right permissions.
// BeforeAnythingElse

// Benchmark Process Environment Information:
// BenchmarkDotNet v0.14.0
// Runtime=.NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2
// GC=Concurrent Workstation
// HardwareIntrinsics=AVX2,AES,BMI1,BMI2,FMA,LZCNT,PCLMUL,POPCNT,AvxVnni,SERIALIZE VectorSize=256
// Job: Job-BDWKHM(IterationCount=10, RunStrategy=Throughput, WarmupCount=3)

Starting Kafka container via Testcontainers...
[testcontainers.org 00:00:00.09] Connected to Docker:
  Host: unix:///var/run/docker.sock
  Server Version: 29.2.0
  Kernel Version: 6.17.0-8-generic
  API Version: 1.53
  Operating System: Ubuntu 25.10
  Total Memory: 30.58 GB
[testcontainers.org 00:00:00.19] Docker container c92287764e77 created
[testcontainers.org 00:00:00.21] Start Docker container c92287764e77
[testcontainers.org 00:00:00.32] Wait for Docker container c92287764e77 to complete readiness checks
[testcontainers.org 00:00:00.32] Docker container c92287764e77 ready
[testcontainers.org 00:00:02.39] Docker container b3644ef79626 created
[testcontainers.org 00:00:02.39] Start Docker container b3644ef79626
[testcontainers.org 00:00:02.51] Add file to tar archive: Content length: 390 byte(s), Target file: "/testcontainers.sh", UID: 0, GID: 0, Mode: 0755
[testcontainers.org 00:00:02.52] Copy tar archive to container: Content length: 390 byte(s), Docker container: b3644ef79626
[testcontainers.org 00:00:02.52] Wait for Docker container b3644ef79626 to complete readiness checks
[testcontainers.org 00:00:05.56] Docker container b3644ef79626 ready
Kafka started at plaintext://127.0.0.1:32814/
Waiting for Kafka to be ready...
Kafka is ready with 1 broker(s)
[testcontainers.org 00:00:05.79] Execute "kafka-topics --bootstrap-server localhost:9092 --create --topic benchmark-producer --partitions 3 --replication-factor 1" at Docker container b3644ef79626
Warning: Failed to create topic benchmark-producer: [2026-01-27 23:26:51,778] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:51,832] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:51,930] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:52,142] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:52,464] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:53,296] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:54,456] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:55,469] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:56,632] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:57,534] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:58,619] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:26:59,440] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:00,366] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:01,395] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:02,480] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:03,534] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:04,510] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:05,417] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:06,607] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:07,463] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:08,266] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:09,096] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:10,115] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:10,993] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:11,895] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:13,043] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:13,911] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:14,716] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:15,762] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:16,595] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:17,756] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:18,713] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:19,782] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:20,860] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:21,870] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:23,018] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:23,853] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:25,020] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:25,868] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:26,859] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:27,774] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:28,581] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:29,620] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:30,635] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:31,705] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:32,546] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:33,555] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:34,754] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:35,950] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:36,999] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:38,119] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:39,037] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:39,977] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:41,109] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:42,111] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:43,250] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:44,213] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:45,275] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:46,219] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:47,368] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:48,435] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:49,574] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:50,580] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32814) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:51,655] ERROR org.apache.kafka.common.errors.TimeoutException: Timed out waiting for a node assignment. Call: createTopics
 (kafka.admin.TopicCommand$)

System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.
 ---> System.InvalidOperationException: Failed to refresh metadata from any broker
   at Dekaf.Metadata.MetadataManager.RefreshMetadataInternalAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 278
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 218
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 204
   at Dekaf.Metadata.MetadataManager.InitializeAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 105
   at Dekaf.Producer.KafkaProducer`2.ProduceInternalAsync(ProducerMessage`2 message, PooledValueTaskSource`1 completion, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 970
   at Dekaf.Producer.KafkaProducer`2.ProcessWorkAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 950
   at Dekaf.Producer.PooledValueTaskSource`1.System.Threading.Tasks.Sources.IValueTaskSource<T>.GetResult(Int16 token) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/PooledValueTaskSource.cs:line 145
   at Dekaf.Producer.KafkaProducer`2.ProduceAsyncSlow(ProducerMessage`2 message, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 287
   at Dekaf.Benchmarks.ProducerBenchmarks.WarmupAsync() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 67
   at Dekaf.Benchmarks.ProducerBenchmarks.Setup() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 59
   at BenchmarkDotNet.Helpers.AwaitHelper.GetResult(Task task)
   at BenchmarkDotNet.Autogenerated.Runnable_11.<.ctor>b__3_0() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 2146
   at BenchmarkDotNet.Engines.EngineFactory.CreateReadyToRun(EngineParameters engineParameters)
   at BenchmarkDotNet.Autogenerated.Runnable_11.Run(IHost host, String benchmarkName) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 2130
   at System.Reflection.MethodBaseInvoker.InterpretedInvoke_Method(Object obj, IntPtr* args)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   --- End of inner exception stack trace ---
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at BenchmarkDotNet.Autogenerated.UniqueProgramName.AfterAssemblyLoadingAttached(String[] args) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 57
// AfterAll
No Workload Results were obtained from the run.
// Benchmark Process 1326638 has exited with code 255.

// ** Remained 16 (57.1%) benchmark(s) to run. Estimated finish 2026-01-27 23:46 (0h 18m from now) **
// **************************
// Benchmark: ProducerBenchmarks.'Dekaf: Fire-and-Forget Direct': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=100, BatchSize=1000]
// *** Execute ***
// Launch: 1 / 1
// Execute: dotnet 8d2c821d-2520-4124-9cd5-dd795016bb32.dll --anonymousPipes 127 128 --benchmarkName "Dekaf.Benchmarks.ProducerBenchmarks.FireAndForget_Dekaf_Direct(MessageSize: 100, BatchSize: 1000)" --job "IterationCount=10, RunStrategy=Throughput, WarmupCount=3" --benchmarkId 12 in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/bin/Release/net10.0
// Failed to set up high priority (Permission denied). In order to run benchmarks with high priority, make sure you have the right permissions.
// BeforeAnythingElse

// Benchmark Process Environment Information:
// BenchmarkDotNet v0.14.0
// Runtime=.NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2
// GC=Concurrent Workstation
// HardwareIntrinsics=AVX2,AES,BMI1,BMI2,FMA,LZCNT,PCLMUL,POPCNT,AvxVnni,SERIALIZE VectorSize=256
// Job: Job-JDYRBV(IterationCount=10, RunStrategy=Throughput, WarmupCount=3)

Starting Kafka container via Testcontainers...
[testcontainers.org 00:00:00.08] Connected to Docker:
  Host: unix:///var/run/docker.sock
  Server Version: 29.2.0
  Kernel Version: 6.17.0-8-generic
  API Version: 1.53
  Operating System: Ubuntu 25.10
  Total Memory: 30.58 GB
[testcontainers.org 00:00:00.19] Docker container adde899e8385 created
[testcontainers.org 00:00:00.22] Start Docker container adde899e8385
[testcontainers.org 00:00:00.32] Wait for Docker container adde899e8385 to complete readiness checks
[testcontainers.org 00:00:00.32] Docker container adde899e8385 ready
[testcontainers.org 00:00:02.40] Docker container 3032df3611b7 created
[testcontainers.org 00:00:02.40] Start Docker container 3032df3611b7
[testcontainers.org 00:00:02.54] Add file to tar archive: Content length: 390 byte(s), Target file: "/testcontainers.sh", UID: 0, GID: 0, Mode: 0755
[testcontainers.org 00:00:02.55] Copy tar archive to container: Content length: 390 byte(s), Docker container: 3032df3611b7
[testcontainers.org 00:00:02.55] Wait for Docker container 3032df3611b7 to complete readiness checks
[testcontainers.org 00:00:05.59] Docker container 3032df3611b7 ready
Kafka started at plaintext://127.0.0.1:32818/
Waiting for Kafka to be ready...
Kafka is ready with 1 broker(s)
[testcontainers.org 00:00:05.83] Execute "kafka-topics --bootstrap-server localhost:9092 --create --topic benchmark-producer --partitions 3 --replication-factor 1" at Docker container 3032df3611b7
Warning: Failed to create topic benchmark-producer: [2026-01-27 23:27:58,595] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:58,645] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:58,752] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:58,959] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:27:59,299] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:00,178] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:01,219] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:02,251] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:03,178] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:04,071] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:05,049] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:05,933] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:06,778] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:07,888] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:08,743] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:09,602] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:10,625] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:11,693] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:12,672] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:13,633] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:14,807] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:15,733] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:16,655] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:17,484] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:18,673] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:19,836] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:20,944] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:21,855] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:22,667] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:23,586] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:24,596] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:25,711] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:26,571] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:27,733] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:28,839] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:29,853] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:31,010] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:31,823] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:32,695] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:33,753] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:34,794] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:35,849] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:36,662] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:37,480] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:38,502] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:39,485] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:40,614] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:41,721] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:42,744] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:43,751] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:44,761] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:45,761] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:46,680] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:47,725] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:48,829] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:49,989] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:50,856] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:51,747] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:52,817] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:53,722] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:54,818] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:55,782] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:56,908] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:58,006] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32818) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:28:58,479] ERROR org.apache.kafka.common.errors.TimeoutException: Timed out waiting for a node assignment. Call: createTopics
 (kafka.admin.TopicCommand$)

System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.
 ---> System.InvalidOperationException: Failed to refresh metadata from any broker
   at Dekaf.Metadata.MetadataManager.RefreshMetadataInternalAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 278
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 218
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 204
   at Dekaf.Metadata.MetadataManager.InitializeAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 105
   at Dekaf.Producer.KafkaProducer`2.ProduceInternalAsync(ProducerMessage`2 message, PooledValueTaskSource`1 completion, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 970
   at Dekaf.Producer.KafkaProducer`2.ProcessWorkAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 950
   at Dekaf.Producer.PooledValueTaskSource`1.System.Threading.Tasks.Sources.IValueTaskSource<T>.GetResult(Int16 token) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/PooledValueTaskSource.cs:line 145
   at Dekaf.Producer.KafkaProducer`2.ProduceAsyncSlow(ProducerMessage`2 message, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 287
   at Dekaf.Benchmarks.ProducerBenchmarks.WarmupAsync() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 67
   at Dekaf.Benchmarks.ProducerBenchmarks.Setup() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 59
   at BenchmarkDotNet.Helpers.AwaitHelper.GetResult(Task task)
   at BenchmarkDotNet.Autogenerated.Runnable_12.<.ctor>b__3_0() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 2340
   at BenchmarkDotNet.Engines.EngineFactory.CreateReadyToRun(EngineParameters engineParameters)
   at BenchmarkDotNet.Autogenerated.Runnable_12.Run(IHost host, String benchmarkName) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 2324
   at System.Reflection.MethodBaseInvoker.InterpretedInvoke_Method(Object obj, IntPtr* args)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   --- End of inner exception stack trace ---
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at BenchmarkDotNet.Autogenerated.UniqueProgramName.AfterAssemblyLoadingAttached(String[] args) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 57
// AfterAll
No Workload Results were obtained from the run.
// Benchmark Process 1333634 has exited with code 255.

// ** Remained 15 (53.6%) benchmark(s) to run. Estimated finish 2026-01-27 23:46 (0h 17m from now) **
// **************************
// Benchmark: ProducerBenchmarks.'Confluent: Fire-and-Forget Produce': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=100, BatchSize=1000]
// *** Execute ***
// Launch: 1 / 1
// Execute: dotnet 8d2c821d-2520-4124-9cd5-dd795016bb32.dll --anonymousPipes 127 128 --benchmarkName "Dekaf.Benchmarks.ProducerBenchmarks.FireAndForget_Confluent(MessageSize: 100, BatchSize: 1000)" --job "IterationCount=10, RunStrategy=Throughput, WarmupCount=3" --benchmarkId 13 in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/bin/Release/net10.0
// Failed to set up high priority (Permission denied). In order to run benchmarks with high priority, make sure you have the right permissions.
// BeforeAnythingElse

// Benchmark Process Environment Information:
// BenchmarkDotNet v0.14.0
// Runtime=.NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2
// GC=Concurrent Workstation
// HardwareIntrinsics=AVX2,AES,BMI1,BMI2,FMA,LZCNT,PCLMUL,POPCNT,AvxVnni,SERIALIZE VectorSize=256
// Job: Job-DTFZXA(IterationCount=10, RunStrategy=Throughput, WarmupCount=3)

Starting Kafka container via Testcontainers...
[testcontainers.org 00:00:00.08] Connected to Docker:
  Host: unix:///var/run/docker.sock
  Server Version: 29.2.0
  Kernel Version: 6.17.0-8-generic
  API Version: 1.53
  Operating System: Ubuntu 25.10
  Total Memory: 30.58 GB
[testcontainers.org 00:00:00.20] Docker container fee6550b2054 created
[testcontainers.org 00:00:00.22] Start Docker container fee6550b2054
[testcontainers.org 00:00:00.33] Wait for Docker container fee6550b2054 to complete readiness checks
[testcontainers.org 00:00:00.33] Docker container fee6550b2054 ready
[testcontainers.org 00:00:02.42] Docker container b3a4347a50e1 created
[testcontainers.org 00:00:02.42] Start Docker container b3a4347a50e1
[testcontainers.org 00:00:02.54] Add file to tar archive: Content length: 390 byte(s), Target file: "/testcontainers.sh", UID: 0, GID: 0, Mode: 0755
[testcontainers.org 00:00:02.55] Copy tar archive to container: Content length: 390 byte(s), Docker container: b3a4347a50e1
[testcontainers.org 00:00:02.55] Wait for Docker container b3a4347a50e1 to complete readiness checks
[testcontainers.org 00:00:05.59] Docker container b3a4347a50e1 ready
Kafka started at plaintext://127.0.0.1:32822/
Waiting for Kafka to be ready...
Kafka is ready with 1 broker(s)
[testcontainers.org 00:00:05.83] Execute "kafka-topics --bootstrap-server localhost:9092 --create --topic benchmark-producer --partitions 3 --replication-factor 1" at Docker container b3a4347a50e1
Warning: Failed to create topic benchmark-producer: [2026-01-27 23:29:05,390] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:05,432] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:05,518] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:05,690] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:06,129] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:06,794] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:07,639] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:08,602] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:09,788] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:10,970] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:12,138] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:13,001] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:14,151] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:15,087] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:16,173] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:17,018] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:18,045] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:18,987] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:19,909] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:20,950] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:21,803] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:22,841] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:23,969] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:24,959] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:25,777] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:26,694] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:27,750] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:28,801] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:29,675] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:30,570] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:31,569] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:32,461] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:33,506] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:34,636] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:35,532] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:36,407] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:37,483] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:38,673] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:39,555] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:40,703] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:41,730] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:42,749] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:43,734] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:44,655] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:45,473] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:46,365] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:47,286] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:48,271] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:49,240] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:50,128] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:51,275] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:52,179] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:53,369] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:54,416] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:55,375] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:56,357] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:57,296] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:58,494] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:29:59,603] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:00,523] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:01,514] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:02,411] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:03,445] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:04,590] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32822) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:05,272] ERROR org.apache.kafka.common.errors.TimeoutException: Timed out waiting for a node assignment. Call: createTopics
 (kafka.admin.TopicCommand$)

System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.
 ---> System.InvalidOperationException: Failed to refresh metadata from any broker
   at Dekaf.Metadata.MetadataManager.RefreshMetadataInternalAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 278
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 218
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 204
   at Dekaf.Metadata.MetadataManager.InitializeAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 105
   at Dekaf.Producer.KafkaProducer`2.ProduceInternalAsync(ProducerMessage`2 message, PooledValueTaskSource`1 completion, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 970
   at Dekaf.Producer.KafkaProducer`2.ProcessWorkAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 950
   at Dekaf.Producer.PooledValueTaskSource`1.System.Threading.Tasks.Sources.IValueTaskSource<T>.GetResult(Int16 token) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/PooledValueTaskSource.cs:line 145
   at Dekaf.Producer.KafkaProducer`2.ProduceAsyncSlow(ProducerMessage`2 message, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 287
   at Dekaf.Benchmarks.ProducerBenchmarks.WarmupAsync() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 67
   at Dekaf.Benchmarks.ProducerBenchmarks.Setup() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 59
   at BenchmarkDotNet.Helpers.AwaitHelper.GetResult(Task task)
   at BenchmarkDotNet.Autogenerated.Runnable_13.<.ctor>b__3_0() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 2534
   at BenchmarkDotNet.Engines.EngineFactory.CreateReadyToRun(EngineParameters engineParameters)
   at BenchmarkDotNet.Autogenerated.Runnable_13.Run(IHost host, String benchmarkName) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 2518
   at System.Reflection.MethodBaseInvoker.InterpretedInvoke_Method(Object obj, IntPtr* args)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   --- End of inner exception stack trace ---
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at BenchmarkDotNet.Autogenerated.UniqueProgramName.AfterAssemblyLoadingAttached(String[] args) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 57
// AfterAll
No Workload Results were obtained from the run.
// Benchmark Process 1340856 has exited with code 255.

// ** Remained 14 (50.0%) benchmark(s) to run. Estimated finish 2026-01-27 23:46 (0h 16m from now) **
// **************************
// Benchmark: ProducerBenchmarks.'Dekaf: Single Message Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=1000, BatchSize=100]
// *** Execute ***
// Launch: 1 / 1
// Execute: dotnet 8d2c821d-2520-4124-9cd5-dd795016bb32.dll --anonymousPipes 127 128 --benchmarkName "Dekaf.Benchmarks.ProducerBenchmarks.SingleProduce_Dekaf(MessageSize: 1000, BatchSize: 100)" --job "InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3" --benchmarkId 14 in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/bin/Release/net10.0
// Failed to set up high priority (Permission denied). In order to run benchmarks with high priority, make sure you have the right permissions.
// BeforeAnythingElse

// Benchmark Process Environment Information:
// BenchmarkDotNet v0.14.0
// Runtime=.NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2
// GC=Concurrent Workstation
// HardwareIntrinsics=AVX2,AES,BMI1,BMI2,FMA,LZCNT,PCLMUL,POPCNT,AvxVnni,SERIALIZE VectorSize=256
// Job: Job-OEHIHY(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3)

Starting Kafka container via Testcontainers...
[testcontainers.org 00:00:00.08] Connected to Docker:
  Host: unix:///var/run/docker.sock
  Server Version: 29.2.0
  Kernel Version: 6.17.0-8-generic
  API Version: 1.53
  Operating System: Ubuntu 25.10
  Total Memory: 30.58 GB
[testcontainers.org 00:00:00.19] Docker container 7bef627b3669 created
[testcontainers.org 00:00:00.22] Start Docker container 7bef627b3669
[testcontainers.org 00:00:00.32] Wait for Docker container 7bef627b3669 to complete readiness checks
[testcontainers.org 00:00:00.32] Docker container 7bef627b3669 ready
[testcontainers.org 00:00:02.39] Docker container 61585f020c38 created
[testcontainers.org 00:00:02.39] Start Docker container 61585f020c38
[testcontainers.org 00:00:02.50] Add file to tar archive: Content length: 390 byte(s), Target file: "/testcontainers.sh", UID: 0, GID: 0, Mode: 0755
[testcontainers.org 00:00:02.50] Copy tar archive to container: Content length: 390 byte(s), Docker container: 61585f020c38
[testcontainers.org 00:00:02.51] Wait for Docker container 61585f020c38 to complete readiness checks
[testcontainers.org 00:00:05.55] Docker container 61585f020c38 ready
Kafka started at plaintext://127.0.0.1:32826/
Waiting for Kafka to be ready...
Kafka is ready with 1 broker(s)
[testcontainers.org 00:00:05.79] Execute "kafka-topics --bootstrap-server localhost:9092 --create --topic benchmark-producer --partitions 3 --replication-factor 1" at Docker container 61585f020c38
Warning: Failed to create topic benchmark-producer: [2026-01-27 23:30:12,145] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:12,192] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:12,310] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:12,476] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:12,827] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:13,571] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:14,664] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:15,522] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:16,715] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:17,597] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:18,683] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:19,763] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:20,750] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:21,833] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:22,869] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:23,883] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:25,070] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:26,109] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:27,057] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:28,147] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:29,140] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:30,105] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:31,202] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:32,044] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:32,962] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:33,804] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:34,890] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:35,692] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:36,788] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:37,791] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:38,736] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:39,934] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:41,045] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:42,228] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:43,059] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:43,906] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:44,750] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:45,885] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:47,048] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:48,172] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:49,294] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:50,457] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:51,525] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:52,360] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:53,361] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:54,396] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:55,385] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:56,305] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:57,272] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:58,112] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:30:59,133] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:00,084] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:00,998] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:02,119] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:03,065] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:04,172] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:05,137] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:06,023] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:06,926] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:08,015] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:08,992] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:10,123] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:11,167] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32826) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:12,027] ERROR org.apache.kafka.common.errors.TimeoutException: Timed out waiting for a node assignment. Call: createTopics
 (kafka.admin.TopicCommand$)

System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.
 ---> System.InvalidOperationException: Failed to refresh metadata from any broker
   at Dekaf.Metadata.MetadataManager.RefreshMetadataInternalAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 278
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 218
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 204
   at Dekaf.Metadata.MetadataManager.InitializeAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 105
   at Dekaf.Producer.KafkaProducer`2.ProduceInternalAsync(ProducerMessage`2 message, PooledValueTaskSource`1 completion, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 970
   at Dekaf.Producer.KafkaProducer`2.ProcessWorkAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 950
   at Dekaf.Producer.PooledValueTaskSource`1.System.Threading.Tasks.Sources.IValueTaskSource<T>.GetResult(Int16 token) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/PooledValueTaskSource.cs:line 145
   at Dekaf.Producer.KafkaProducer`2.ProduceAsyncSlow(ProducerMessage`2 message, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 287
   at Dekaf.Benchmarks.ProducerBenchmarks.WarmupAsync() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 67
   at Dekaf.Benchmarks.ProducerBenchmarks.Setup() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 59
   at BenchmarkDotNet.Helpers.AwaitHelper.GetResult(Task task)
   at BenchmarkDotNet.Autogenerated.Runnable_14.<.ctor>b__3_0() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 2730
   at BenchmarkDotNet.Engines.EngineFactory.CreateReadyToRun(EngineParameters engineParameters)
   at BenchmarkDotNet.Autogenerated.Runnable_14.Run(IHost host, String benchmarkName) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 2714
   at System.Reflection.MethodBaseInvoker.InterpretedInvoke_Method(Object obj, IntPtr* args)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   --- End of inner exception stack trace ---
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at BenchmarkDotNet.Autogenerated.UniqueProgramName.AfterAssemblyLoadingAttached(String[] args) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 57
// AfterAll
No Workload Results were obtained from the run.
// Benchmark Process 1347748 has exited with code 255.

// ** Remained 13 (46.4%) benchmark(s) to run. Estimated finish 2026-01-27 23:46 (0h 14m from now) **
// **************************
// Benchmark: ProducerBenchmarks.'Confluent: Single Message Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=1000, BatchSize=100]
// *** Execute ***
// Launch: 1 / 1
// Execute: dotnet 8d2c821d-2520-4124-9cd5-dd795016bb32.dll --anonymousPipes 127 128 --benchmarkName "Dekaf.Benchmarks.ProducerBenchmarks.SingleProduce_Confluent(MessageSize: 1000, BatchSize: 100)" --job "InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3" --benchmarkId 15 in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/bin/Release/net10.0
// Failed to set up high priority (Permission denied). In order to run benchmarks with high priority, make sure you have the right permissions.
// BeforeAnythingElse

// Benchmark Process Environment Information:
// BenchmarkDotNet v0.14.0
// Runtime=.NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2
// GC=Concurrent Workstation
// HardwareIntrinsics=AVX2,AES,BMI1,BMI2,FMA,LZCNT,PCLMUL,POPCNT,AvxVnni,SERIALIZE VectorSize=256
// Job: Job-TNUQWH(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3)

Starting Kafka container via Testcontainers...
[testcontainers.org 00:00:00.09] Connected to Docker:
  Host: unix:///var/run/docker.sock
  Server Version: 29.2.0
  Kernel Version: 6.17.0-8-generic
  API Version: 1.53
  Operating System: Ubuntu 25.10
  Total Memory: 30.58 GB
[testcontainers.org 00:00:00.19] Docker container 84c2b4c62183 created
[testcontainers.org 00:00:00.22] Start Docker container 84c2b4c62183
[testcontainers.org 00:00:00.32] Wait for Docker container 84c2b4c62183 to complete readiness checks
[testcontainers.org 00:00:00.32] Docker container 84c2b4c62183 ready
[testcontainers.org 00:00:02.42] Docker container b3af64f115c6 created
[testcontainers.org 00:00:02.42] Start Docker container b3af64f115c6
[testcontainers.org 00:00:02.53] Add file to tar archive: Content length: 390 byte(s), Target file: "/testcontainers.sh", UID: 0, GID: 0, Mode: 0755
[testcontainers.org 00:00:02.54] Copy tar archive to container: Content length: 390 byte(s), Docker container: b3af64f115c6
[testcontainers.org 00:00:02.54] Wait for Docker container b3af64f115c6 to complete readiness checks
[testcontainers.org 00:00:05.59] Docker container b3af64f115c6 ready
Kafka started at plaintext://127.0.0.1:32830/
Waiting for Kafka to be ready...
Kafka is ready with 1 broker(s)
[testcontainers.org 00:00:05.83] Execute "kafka-topics --bootstrap-server localhost:9092 --create --topic benchmark-producer --partitions 3 --replication-factor 1" at Docker container b3af64f115c6
Warning: Failed to create topic benchmark-producer: [2026-01-27 23:31:18,936] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:18,983] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:19,101] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:19,291] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:19,739] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:20,655] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:21,741] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:22,725] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:23,541] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:24,739] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:25,911] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:26,899] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:28,051] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:28,954] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:29,927] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:30,911] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:32,089] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:33,165] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:33,987] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:34,789] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:35,730] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:36,909] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:37,894] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:39,045] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:40,234] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:41,149] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:42,059] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:43,028] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:43,989] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:45,028] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:46,146] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:47,150] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:47,997] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:49,066] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:49,960] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:50,865] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:51,915] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:52,728] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:53,557] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:54,709] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:55,625] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:56,754] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:57,848] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:58,654] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:31:59,627] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:00,731] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:01,714] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:02,835] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:03,745] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:04,603] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:05,577] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:06,766] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:07,746] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:08,708] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:09,562] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:10,464] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:11,465] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:12,361] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:13,200] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:14,379] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:15,352] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:16,470] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:17,523] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:18,394] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32830) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:18,825] ERROR org.apache.kafka.common.errors.TimeoutException: Timed out waiting for a node assignment. Call: createTopics
 (kafka.admin.TopicCommand$)

System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.
 ---> System.InvalidOperationException: Failed to refresh metadata from any broker
   at Dekaf.Metadata.MetadataManager.RefreshMetadataInternalAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 278
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 218
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 204
   at Dekaf.Metadata.MetadataManager.InitializeAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 105
   at Dekaf.Producer.KafkaProducer`2.ProduceInternalAsync(ProducerMessage`2 message, PooledValueTaskSource`1 completion, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 970
   at Dekaf.Producer.KafkaProducer`2.ProcessWorkAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 950
   at Dekaf.Producer.PooledValueTaskSource`1.System.Threading.Tasks.Sources.IValueTaskSource<T>.GetResult(Int16 token) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/PooledValueTaskSource.cs:line 145
   at Dekaf.Producer.KafkaProducer`2.ProduceAsyncSlow(ProducerMessage`2 message, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 287
   at Dekaf.Benchmarks.ProducerBenchmarks.WarmupAsync() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 67
   at Dekaf.Benchmarks.ProducerBenchmarks.Setup() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 59
   at BenchmarkDotNet.Helpers.AwaitHelper.GetResult(Task task)
   at BenchmarkDotNet.Autogenerated.Runnable_15.<.ctor>b__3_0() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 2912
   at BenchmarkDotNet.Engines.EngineFactory.CreateReadyToRun(EngineParameters engineParameters)
   at BenchmarkDotNet.Autogenerated.Runnable_15.Run(IHost host, String benchmarkName) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 2896
   at System.Reflection.MethodBaseInvoker.InterpretedInvoke_Method(Object obj, IntPtr* args)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   --- End of inner exception stack trace ---
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at BenchmarkDotNet.Autogenerated.UniqueProgramName.AfterAssemblyLoadingAttached(String[] args) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 57
// AfterAll
No Workload Results were obtained from the run.
// Benchmark Process 1354600 has exited with code 255.

// ** Remained 12 (42.9%) benchmark(s) to run. Estimated finish 2026-01-27 23:46 (0h 13m from now) **
// **************************
// Benchmark: ProducerBenchmarks.'Dekaf: Batch Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=1000, BatchSize=100]
// *** Execute ***
// Launch: 1 / 1
// Execute: dotnet 8d2c821d-2520-4124-9cd5-dd795016bb32.dll --anonymousPipes 127 128 --benchmarkName "Dekaf.Benchmarks.ProducerBenchmarks.BatchProduce_Dekaf(MessageSize: 1000, BatchSize: 100)" --job "InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3" --benchmarkId 16 in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/bin/Release/net10.0
// Failed to set up high priority (Permission denied). In order to run benchmarks with high priority, make sure you have the right permissions.
// BeforeAnythingElse

// Benchmark Process Environment Information:
// BenchmarkDotNet v0.14.0
// Runtime=.NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2
// GC=Concurrent Workstation
// HardwareIntrinsics=AVX2,AES,BMI1,BMI2,FMA,LZCNT,PCLMUL,POPCNT,AvxVnni,SERIALIZE VectorSize=256
// Job: Job-CVHSYX(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3)

Starting Kafka container via Testcontainers...
[testcontainers.org 00:00:00.09] Connected to Docker:
  Host: unix:///var/run/docker.sock
  Server Version: 29.2.0
  Kernel Version: 6.17.0-8-generic
  API Version: 1.53
  Operating System: Ubuntu 25.10
  Total Memory: 30.58 GB
[testcontainers.org 00:00:00.20] Docker container e193e2053395 created
[testcontainers.org 00:00:00.22] Start Docker container e193e2053395
[testcontainers.org 00:00:00.32] Wait for Docker container e193e2053395 to complete readiness checks
[testcontainers.org 00:00:00.32] Docker container e193e2053395 ready
[testcontainers.org 00:00:02.38] Docker container d17a5ea51c53 created
[testcontainers.org 00:00:02.38] Start Docker container d17a5ea51c53
[testcontainers.org 00:00:02.49] Add file to tar archive: Content length: 390 byte(s), Target file: "/testcontainers.sh", UID: 0, GID: 0, Mode: 0755
[testcontainers.org 00:00:02.49] Copy tar archive to container: Content length: 390 byte(s), Docker container: d17a5ea51c53
[testcontainers.org 00:00:02.50] Wait for Docker container d17a5ea51c53 to complete readiness checks
[testcontainers.org 00:00:05.54] Docker container d17a5ea51c53 ready
Kafka started at plaintext://127.0.0.1:32834/
Waiting for Kafka to be ready...
Kafka is ready with 1 broker(s)
[testcontainers.org 00:00:05.79] Execute "kafka-topics --bootstrap-server localhost:9092 --create --topic benchmark-producer --partitions 3 --replication-factor 1" at Docker container d17a5ea51c53
Warning: Failed to create topic benchmark-producer: [2026-01-27 23:32:25,859] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:25,901] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:26,002] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:26,183] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:26,553] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:27,463] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:28,297] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:29,447] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:30,405] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:31,255] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:32,197] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:33,006] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:33,849] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:34,870] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:35,738] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:36,743] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:37,742] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:38,819] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:39,905] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:41,034] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:41,991] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:42,862] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:44,058] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:45,052] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:45,896] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:46,847] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:47,989] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:49,176] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:49,992] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:51,085] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:52,035] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:52,982] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:54,138] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:55,031] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:55,913] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:56,802] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:57,930] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:59,060] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:32:59,970] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:01,082] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:02,092] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:03,103] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:04,299] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:05,259] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:06,074] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:06,901] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:07,837] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:08,790] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:09,680] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:10,756] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:11,676] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:12,648] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:13,791] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:14,752] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:15,727] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:16,823] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:17,816] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:18,793] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:19,850] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:21,009] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:21,891] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:22,986] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:23,873] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:24,795] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32834) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:25,748] ERROR org.apache.kafka.common.errors.TimeoutException: Timed out waiting for a node assignment. Call: createTopics
 (kafka.admin.TopicCommand$)

System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.
 ---> System.InvalidOperationException: Failed to refresh metadata from any broker
   at Dekaf.Metadata.MetadataManager.RefreshMetadataInternalAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 278
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 218
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 204
   at Dekaf.Metadata.MetadataManager.InitializeAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 105
   at Dekaf.Producer.KafkaProducer`2.ProduceInternalAsync(ProducerMessage`2 message, PooledValueTaskSource`1 completion, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 970
   at Dekaf.Producer.KafkaProducer`2.ProcessWorkAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 950
   at Dekaf.Producer.PooledValueTaskSource`1.System.Threading.Tasks.Sources.IValueTaskSource<T>.GetResult(Int16 token) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/PooledValueTaskSource.cs:line 145
   at Dekaf.Producer.KafkaProducer`2.ProduceAsyncSlow(ProducerMessage`2 message, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 287
   at Dekaf.Benchmarks.ProducerBenchmarks.WarmupAsync() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 67
   at Dekaf.Benchmarks.ProducerBenchmarks.Setup() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 59
   at BenchmarkDotNet.Helpers.AwaitHelper.GetResult(Task task)
   at BenchmarkDotNet.Autogenerated.Runnable_16.<.ctor>b__3_0() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 3083
   at BenchmarkDotNet.Engines.EngineFactory.CreateReadyToRun(EngineParameters engineParameters)
   at BenchmarkDotNet.Autogenerated.Runnable_16.Run(IHost host, String benchmarkName) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 3067
   at System.Reflection.MethodBaseInvoker.InterpretedInvoke_Method(Object obj, IntPtr* args)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   --- End of inner exception stack trace ---
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at BenchmarkDotNet.Autogenerated.UniqueProgramName.AfterAssemblyLoadingAttached(String[] args) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 57
// AfterAll
No Workload Results were obtained from the run.
// Benchmark Process 1361458 has exited with code 255.

// ** Remained 11 (39.3%) benchmark(s) to run. Estimated finish 2026-01-27 23:46 (0h 12m from now) **
// **************************
// Benchmark: ProducerBenchmarks.'Confluent: Batch Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=1000, BatchSize=100]
// *** Execute ***
// Launch: 1 / 1
// Execute: dotnet 8d2c821d-2520-4124-9cd5-dd795016bb32.dll --anonymousPipes 127 128 --benchmarkName "Dekaf.Benchmarks.ProducerBenchmarks.BatchProduce_Confluent(MessageSize: 1000, BatchSize: 100)" --job "InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3" --benchmarkId 17 in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/bin/Release/net10.0
// Failed to set up high priority (Permission denied). In order to run benchmarks with high priority, make sure you have the right permissions.
// BeforeAnythingElse

// Benchmark Process Environment Information:
// BenchmarkDotNet v0.14.0
// Runtime=.NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2
// GC=Concurrent Workstation
// HardwareIntrinsics=AVX2,AES,BMI1,BMI2,FMA,LZCNT,PCLMUL,POPCNT,AvxVnni,SERIALIZE VectorSize=256
// Job: Job-CUNNEZ(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3)

Starting Kafka container via Testcontainers...
[testcontainers.org 00:00:00.09] Connected to Docker:
  Host: unix:///var/run/docker.sock
  Server Version: 29.2.0
  Kernel Version: 6.17.0-8-generic
  API Version: 1.53
  Operating System: Ubuntu 25.10
  Total Memory: 30.58 GB
[testcontainers.org 00:00:00.19] Docker container 522a2f278a46 created
[testcontainers.org 00:00:00.21] Start Docker container 522a2f278a46
[testcontainers.org 00:00:00.30] Wait for Docker container 522a2f278a46 to complete readiness checks
[testcontainers.org 00:00:00.30] Docker container 522a2f278a46 ready
[testcontainers.org 00:00:02.38] Docker container 7e51f3f9d0f4 created
[testcontainers.org 00:00:02.38] Start Docker container 7e51f3f9d0f4
[testcontainers.org 00:00:02.49] Add file to tar archive: Content length: 390 byte(s), Target file: "/testcontainers.sh", UID: 0, GID: 0, Mode: 0755
[testcontainers.org 00:00:02.49] Copy tar archive to container: Content length: 390 byte(s), Docker container: 7e51f3f9d0f4
[testcontainers.org 00:00:02.50] Wait for Docker container 7e51f3f9d0f4 to complete readiness checks
[testcontainers.org 00:00:05.54] Docker container 7e51f3f9d0f4 ready
Kafka started at plaintext://127.0.0.1:32838/
Waiting for Kafka to be ready...
Kafka is ready with 1 broker(s)
[testcontainers.org 00:00:05.78] Execute "kafka-topics --bootstrap-server localhost:9092 --create --topic benchmark-producer --partitions 3 --replication-factor 1" at Docker container 7e51f3f9d0f4
Warning: Failed to create topic benchmark-producer: [2026-01-27 23:33:32,620] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:32,668] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:32,774] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:32,942] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:33,393] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:34,275] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:35,094] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:36,245] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:37,221] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:38,148] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:39,134] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:39,982] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:40,934] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:41,967] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:43,023] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:44,098] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:44,934] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:45,957] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:46,844] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:47,992] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:48,863] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:49,967] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:50,983] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:52,105] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:52,911] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:53,738] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:54,880] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:56,037] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:56,969] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:57,806] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:58,634] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:33:59,481] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:00,485] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:01,339] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:02,406] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:03,229] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:04,255] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:05,351] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:06,351] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:07,326] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:08,394] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:09,199] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:10,009] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:10,824] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:11,876] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:12,744] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:13,671] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:14,575] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:15,705] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:16,676] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:17,629] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:18,820] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:19,796] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:20,984] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:22,084] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:23,136] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:24,200] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:25,195] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:26,273] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:27,210] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:28,384] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:29,277] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:30,355] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:31,356] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32838) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:32,507] ERROR org.apache.kafka.common.errors.TimeoutException: Timed out waiting for a node assignment. Call: createTopics
 (kafka.admin.TopicCommand$)

System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.
 ---> System.InvalidOperationException: Failed to refresh metadata from any broker
   at Dekaf.Metadata.MetadataManager.RefreshMetadataInternalAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 278
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 218
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 204
   at Dekaf.Metadata.MetadataManager.InitializeAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 105
   at Dekaf.Producer.KafkaProducer`2.ProduceInternalAsync(ProducerMessage`2 message, PooledValueTaskSource`1 completion, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 970
   at Dekaf.Producer.KafkaProducer`2.ProcessWorkAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 950
   at Dekaf.Producer.PooledValueTaskSource`1.System.Threading.Tasks.Sources.IValueTaskSource<T>.GetResult(Int16 token) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/PooledValueTaskSource.cs:line 145
   at Dekaf.Producer.KafkaProducer`2.ProduceAsyncSlow(ProducerMessage`2 message, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 287
   at Dekaf.Benchmarks.ProducerBenchmarks.WarmupAsync() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 67
   at Dekaf.Benchmarks.ProducerBenchmarks.Setup() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 59
   at BenchmarkDotNet.Helpers.AwaitHelper.GetResult(Task task)
   at BenchmarkDotNet.Autogenerated.Runnable_17.<.ctor>b__3_0() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 3249
   at BenchmarkDotNet.Engines.EngineFactory.CreateReadyToRun(EngineParameters engineParameters)
   at BenchmarkDotNet.Autogenerated.Runnable_17.Run(IHost host, String benchmarkName) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 3233
   at System.Reflection.MethodBaseInvoker.InterpretedInvoke_Method(Object obj, IntPtr* args)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   --- End of inner exception stack trace ---
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at BenchmarkDotNet.Autogenerated.UniqueProgramName.AfterAssemblyLoadingAttached(String[] args) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 57
// AfterAll
No Workload Results were obtained from the run.
// Benchmark Process 1368481 has exited with code 255.

// ** Remained 10 (35.7%) benchmark(s) to run. Estimated finish 2026-01-27 23:46 (0h 11m from now) **
// **************************
// Benchmark: ProducerBenchmarks.'Dekaf: Fire-and-Forget Send': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=1000, BatchSize=100]
// *** Execute ***
// Launch: 1 / 1
// Execute: dotnet 8d2c821d-2520-4124-9cd5-dd795016bb32.dll --anonymousPipes 127 128 --benchmarkName "Dekaf.Benchmarks.ProducerBenchmarks.FireAndForget_Dekaf(MessageSize: 1000, BatchSize: 100)" --job "IterationCount=10, RunStrategy=Throughput, WarmupCount=3" --benchmarkId 18 in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/bin/Release/net10.0
// Failed to set up high priority (Permission denied). In order to run benchmarks with high priority, make sure you have the right permissions.
// BeforeAnythingElse

// Benchmark Process Environment Information:
// BenchmarkDotNet v0.14.0
// Runtime=.NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2
// GC=Concurrent Workstation
// HardwareIntrinsics=AVX2,AES,BMI1,BMI2,FMA,LZCNT,PCLMUL,POPCNT,AvxVnni,SERIALIZE VectorSize=256
// Job: Job-BVJTYU(IterationCount=10, RunStrategy=Throughput, WarmupCount=3)

Starting Kafka container via Testcontainers...
[testcontainers.org 00:00:00.09] Connected to Docker:
  Host: unix:///var/run/docker.sock
  Server Version: 29.2.0
  Kernel Version: 6.17.0-8-generic
  API Version: 1.53
  Operating System: Ubuntu 25.10
  Total Memory: 30.58 GB
[testcontainers.org 00:00:00.21] Docker container 38cbdf159847 created
[testcontainers.org 00:00:00.23] Start Docker container 38cbdf159847
[testcontainers.org 00:00:00.32] Wait for Docker container 38cbdf159847 to complete readiness checks
[testcontainers.org 00:00:00.32] Docker container 38cbdf159847 ready
[testcontainers.org 00:00:02.40] Docker container 1119e7ebaeb0 created
[testcontainers.org 00:00:02.41] Start Docker container 1119e7ebaeb0
[testcontainers.org 00:00:02.52] Add file to tar archive: Content length: 390 byte(s), Target file: "/testcontainers.sh", UID: 0, GID: 0, Mode: 0755
[testcontainers.org 00:00:02.52] Copy tar archive to container: Content length: 390 byte(s), Docker container: 1119e7ebaeb0
[testcontainers.org 00:00:02.53] Wait for Docker container 1119e7ebaeb0 to complete readiness checks
[testcontainers.org 00:00:05.57] Docker container 1119e7ebaeb0 ready
Kafka started at plaintext://127.0.0.1:32842/
Waiting for Kafka to be ready...
Kafka is ready with 1 broker(s)
[testcontainers.org 00:00:05.80] Execute "kafka-topics --bootstrap-server localhost:9092 --create --topic benchmark-producer --partitions 3 --replication-factor 1" at Docker container 1119e7ebaeb0
Warning: Failed to create topic benchmark-producer: [2026-01-27 23:34:39,440] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:39,498] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:39,593] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:39,806] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:40,162] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:40,805] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:41,702] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:42,629] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:43,673] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:44,567] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:45,764] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:46,943] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:47,820] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:49,004] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:50,155] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:51,080] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:52,153] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:52,969] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:53,896] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:54,959] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:56,075] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:57,213] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:58,160] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:34:59,113] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:00,011] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:00,875] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:01,967] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:02,928] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:03,833] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:04,637] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:05,587] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:06,484] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:07,479] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:08,400] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:09,547] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:10,737] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:11,603] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:12,792] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:13,902] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:14,859] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:15,758] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:16,833] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:17,920] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:18,969] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:19,929] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:21,118] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:22,014] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:22,849] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:23,795] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:24,707] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:25,553] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:26,731] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:27,902] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:28,804] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:29,726] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:30,666] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:31,637] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:32,531] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:33,688] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:34,564] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:35,436] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:36,467] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:37,538] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:38,510] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32842) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:39,313] ERROR org.apache.kafka.common.errors.TimeoutException: Timed out waiting for a node assignment. Call: createTopics
 (kafka.admin.TopicCommand$)

System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.
 ---> System.InvalidOperationException: Failed to refresh metadata from any broker
   at Dekaf.Metadata.MetadataManager.RefreshMetadataInternalAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 278
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 218
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 204
   at Dekaf.Metadata.MetadataManager.InitializeAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 105
   at Dekaf.Producer.KafkaProducer`2.ProduceInternalAsync(ProducerMessage`2 message, PooledValueTaskSource`1 completion, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 970
   at Dekaf.Producer.KafkaProducer`2.ProcessWorkAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 950
   at Dekaf.Producer.PooledValueTaskSource`1.System.Threading.Tasks.Sources.IValueTaskSource<T>.GetResult(Int16 token) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/PooledValueTaskSource.cs:line 145
   at Dekaf.Producer.KafkaProducer`2.ProduceAsyncSlow(ProducerMessage`2 message, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 287
   at Dekaf.Benchmarks.ProducerBenchmarks.WarmupAsync() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 67
   at Dekaf.Benchmarks.ProducerBenchmarks.Setup() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 59
   at BenchmarkDotNet.Helpers.AwaitHelper.GetResult(Task task)
   at BenchmarkDotNet.Autogenerated.Runnable_18.<.ctor>b__3_0() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 3413
   at BenchmarkDotNet.Engines.EngineFactory.CreateReadyToRun(EngineParameters engineParameters)
   at BenchmarkDotNet.Autogenerated.Runnable_18.Run(IHost host, String benchmarkName) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 3397
   at System.Reflection.MethodBaseInvoker.InterpretedInvoke_Method(Object obj, IntPtr* args)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   --- End of inner exception stack trace ---
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at BenchmarkDotNet.Autogenerated.UniqueProgramName.AfterAssemblyLoadingAttached(String[] args) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 57
// AfterAll
No Workload Results were obtained from the run.
// Benchmark Process 1375794 has exited with code 255.

// ** Remained 9 (32.1%) benchmark(s) to run. Estimated finish 2026-01-27 23:45 (0h 10m from now) **
// **************************
// Benchmark: ProducerBenchmarks.'Dekaf: Fire-and-Forget Direct': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=1000, BatchSize=100]
// *** Execute ***
// Launch: 1 / 1
// Execute: dotnet 8d2c821d-2520-4124-9cd5-dd795016bb32.dll --anonymousPipes 127 128 --benchmarkName "Dekaf.Benchmarks.ProducerBenchmarks.FireAndForget_Dekaf_Direct(MessageSize: 1000, BatchSize: 100)" --job "IterationCount=10, RunStrategy=Throughput, WarmupCount=3" --benchmarkId 19 in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/bin/Release/net10.0
// Failed to set up high priority (Permission denied). In order to run benchmarks with high priority, make sure you have the right permissions.
// BeforeAnythingElse

// Benchmark Process Environment Information:
// BenchmarkDotNet v0.14.0
// Runtime=.NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2
// GC=Concurrent Workstation
// HardwareIntrinsics=AVX2,AES,BMI1,BMI2,FMA,LZCNT,PCLMUL,POPCNT,AvxVnni,SERIALIZE VectorSize=256
// Job: Job-VOSMMU(IterationCount=10, RunStrategy=Throughput, WarmupCount=3)

Starting Kafka container via Testcontainers...
[testcontainers.org 00:00:00.08] Connected to Docker:
  Host: unix:///var/run/docker.sock
  Server Version: 29.2.0
  Kernel Version: 6.17.0-8-generic
  API Version: 1.53
  Operating System: Ubuntu 25.10
  Total Memory: 30.58 GB
[testcontainers.org 00:00:00.18] Docker container 41daee1bdc37 created
[testcontainers.org 00:00:00.20] Start Docker container 41daee1bdc37
[testcontainers.org 00:00:00.30] Wait for Docker container 41daee1bdc37 to complete readiness checks
[testcontainers.org 00:00:00.30] Docker container 41daee1bdc37 ready
[testcontainers.org 00:00:02.38] Docker container 95ecd21a72b1 created
[testcontainers.org 00:00:02.38] Start Docker container 95ecd21a72b1
[testcontainers.org 00:00:02.49] Add file to tar archive: Content length: 390 byte(s), Target file: "/testcontainers.sh", UID: 0, GID: 0, Mode: 0755
[testcontainers.org 00:00:02.50] Copy tar archive to container: Content length: 390 byte(s), Docker container: 95ecd21a72b1
[testcontainers.org 00:00:02.51] Wait for Docker container 95ecd21a72b1 to complete readiness checks
[testcontainers.org 00:00:05.55] Docker container 95ecd21a72b1 ready
Kafka started at plaintext://127.0.0.1:32846/
Waiting for Kafka to be ready...
Kafka is ready with 1 broker(s)
[testcontainers.org 00:00:05.78] Execute "kafka-topics --bootstrap-server localhost:9092 --create --topic benchmark-producer --partitions 3 --replication-factor 1" at Docker container 95ecd21a72b1
Warning: Failed to create topic benchmark-producer: [2026-01-27 23:35:46,171] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:46,230] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:46,340] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:46,562] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:46,916] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:47,818] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:48,845] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:49,964] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:51,044] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:51,992] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:53,093] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:54,045] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:55,054] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:56,019] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:57,106] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:58,275] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:35:59,196] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:00,156] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:01,042] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:02,026] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:03,087] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:04,148] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:05,309] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:06,390] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:07,442] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:08,616] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:09,757] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:10,872] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:12,003] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:13,007] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:13,953] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:15,077] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:16,215] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:17,255] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:18,199] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:19,162] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:20,285] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:21,482] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:22,663] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:23,647] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:24,730] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:25,888] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:26,962] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:28,057] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:28,954] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:30,067] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:31,165] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:32,207] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:33,167] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:34,308] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:35,399] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:36,428] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:37,312] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:38,218] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:39,306] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:40,142] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:41,228] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:42,184] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:43,282] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:44,273] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:45,130] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32846) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:46,064] ERROR org.apache.kafka.common.errors.TimeoutException: Timed out waiting for a node assignment. Call: createTopics
 (kafka.admin.TopicCommand$)

System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.
 ---> System.InvalidOperationException: Failed to refresh metadata from any broker
   at Dekaf.Metadata.MetadataManager.RefreshMetadataInternalAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 278
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 218
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 204
   at Dekaf.Metadata.MetadataManager.InitializeAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 105
   at Dekaf.Producer.KafkaProducer`2.ProduceInternalAsync(ProducerMessage`2 message, PooledValueTaskSource`1 completion, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 970
   at Dekaf.Producer.KafkaProducer`2.ProcessWorkAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 950
   at Dekaf.Producer.PooledValueTaskSource`1.System.Threading.Tasks.Sources.IValueTaskSource<T>.GetResult(Int16 token) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/PooledValueTaskSource.cs:line 145
   at Dekaf.Producer.KafkaProducer`2.ProduceAsyncSlow(ProducerMessage`2 message, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 287
   at Dekaf.Benchmarks.ProducerBenchmarks.WarmupAsync() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 67
   at Dekaf.Benchmarks.ProducerBenchmarks.Setup() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 59
   at BenchmarkDotNet.Helpers.AwaitHelper.GetResult(Task task)
   at BenchmarkDotNet.Autogenerated.Runnable_19.<.ctor>b__3_0() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 3607
   at BenchmarkDotNet.Engines.EngineFactory.CreateReadyToRun(EngineParameters engineParameters)
   at BenchmarkDotNet.Autogenerated.Runnable_19.Run(IHost host, String benchmarkName) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 3591
   at System.Reflection.MethodBaseInvoker.InterpretedInvoke_Method(Object obj, IntPtr* args)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   --- End of inner exception stack trace ---
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at BenchmarkDotNet.Autogenerated.UniqueProgramName.AfterAssemblyLoadingAttached(String[] args) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 57
// AfterAll
No Workload Results were obtained from the run.
// Benchmark Process 1382667 has exited with code 255.

// ** Remained 8 (28.6%) benchmark(s) to run. Estimated finish 2026-01-27 23:45 (0h 9m from now) **
// **************************
// Benchmark: ProducerBenchmarks.'Confluent: Fire-and-Forget Produce': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=1000, BatchSize=100]
// *** Execute ***
// Launch: 1 / 1
// Execute: dotnet 8d2c821d-2520-4124-9cd5-dd795016bb32.dll --anonymousPipes 127 128 --benchmarkName "Dekaf.Benchmarks.ProducerBenchmarks.FireAndForget_Confluent(MessageSize: 1000, BatchSize: 100)" --job "IterationCount=10, RunStrategy=Throughput, WarmupCount=3" --benchmarkId 20 in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/bin/Release/net10.0
// Failed to set up high priority (Permission denied). In order to run benchmarks with high priority, make sure you have the right permissions.
// BeforeAnythingElse

// Benchmark Process Environment Information:
// BenchmarkDotNet v0.14.0
// Runtime=.NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2
// GC=Concurrent Workstation
// HardwareIntrinsics=AVX2,AES,BMI1,BMI2,FMA,LZCNT,PCLMUL,POPCNT,AvxVnni,SERIALIZE VectorSize=256
// Job: Job-XRZTYZ(IterationCount=10, RunStrategy=Throughput, WarmupCount=3)

Starting Kafka container via Testcontainers...
[testcontainers.org 00:00:00.09] Connected to Docker:
  Host: unix:///var/run/docker.sock
  Server Version: 29.2.0
  Kernel Version: 6.17.0-8-generic
  API Version: 1.53
  Operating System: Ubuntu 25.10
  Total Memory: 30.58 GB
[testcontainers.org 00:00:00.19] Docker container 982faa3385b4 created
[testcontainers.org 00:00:00.22] Start Docker container 982faa3385b4
[testcontainers.org 00:00:00.31] Wait for Docker container 982faa3385b4 to complete readiness checks
[testcontainers.org 00:00:00.31] Docker container 982faa3385b4 ready
[testcontainers.org 00:00:02.38] Docker container 071e2bf37914 created
[testcontainers.org 00:00:02.38] Start Docker container 071e2bf37914
[testcontainers.org 00:00:02.51] Add file to tar archive: Content length: 390 byte(s), Target file: "/testcontainers.sh", UID: 0, GID: 0, Mode: 0755
[testcontainers.org 00:00:02.51] Copy tar archive to container: Content length: 390 byte(s), Docker container: 071e2bf37914
[testcontainers.org 00:00:02.52] Wait for Docker container 071e2bf37914 to complete readiness checks
[testcontainers.org 00:00:05.55] Docker container 071e2bf37914 ready
Kafka started at plaintext://127.0.0.1:32850/
Waiting for Kafka to be ready...
Kafka is ready with 1 broker(s)
[testcontainers.org 00:00:05.79] Execute "kafka-topics --bootstrap-server localhost:9092 --create --topic benchmark-producer --partitions 3 --replication-factor 1" at Docker container 071e2bf37914
Warning: Failed to create topic benchmark-producer: [2026-01-27 23:36:52,955] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:53,002] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:53,100] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:53,272] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:53,728] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:54,666] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:55,613] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:56,688] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:57,708] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:58,723] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:36:59,533] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:00,402] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:01,356] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:02,235] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:03,257] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:04,455] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:05,408] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:06,328] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:07,448] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:08,306] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:09,144] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:10,220] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:11,383] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:12,278] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:13,347] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:14,288] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:15,281] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:16,230] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:17,055] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:17,890] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:19,036] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:19,876] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:20,824] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:21,926] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:23,047] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:24,188] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:25,219] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:26,105] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:27,037] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:28,096] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:28,994] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:30,026] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:31,168] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:32,305] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:33,439] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:34,546] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:35,506] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:36,681] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:37,860] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:38,989] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:39,915] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:40,981] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:42,053] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:42,908] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:43,748] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:44,793] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:45,702] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:46,797] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:47,867] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:48,693] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:49,533] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:50,487] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:51,337] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:52,206] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32850) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:52,834] ERROR org.apache.kafka.common.errors.TimeoutException: Timed out waiting for a node assignment. Call: createTopics
 (kafka.admin.TopicCommand$)

System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.
 ---> System.InvalidOperationException: Failed to refresh metadata from any broker
   at Dekaf.Metadata.MetadataManager.RefreshMetadataInternalAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 278
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 218
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 204
   at Dekaf.Metadata.MetadataManager.InitializeAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 105
   at Dekaf.Producer.KafkaProducer`2.ProduceInternalAsync(ProducerMessage`2 message, PooledValueTaskSource`1 completion, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 970
   at Dekaf.Producer.KafkaProducer`2.ProcessWorkAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 950
   at Dekaf.Producer.PooledValueTaskSource`1.System.Threading.Tasks.Sources.IValueTaskSource<T>.GetResult(Int16 token) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/PooledValueTaskSource.cs:line 145
   at Dekaf.Producer.KafkaProducer`2.ProduceAsyncSlow(ProducerMessage`2 message, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 287
   at Dekaf.Benchmarks.ProducerBenchmarks.WarmupAsync() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 67
   at Dekaf.Benchmarks.ProducerBenchmarks.Setup() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 59
   at BenchmarkDotNet.Helpers.AwaitHelper.GetResult(Task task)
   at BenchmarkDotNet.Autogenerated.Runnable_20.<.ctor>b__3_0() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 3801
   at BenchmarkDotNet.Engines.EngineFactory.CreateReadyToRun(EngineParameters engineParameters)
   at BenchmarkDotNet.Autogenerated.Runnable_20.Run(IHost host, String benchmarkName) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 3785
   at System.Reflection.MethodBaseInvoker.InterpretedInvoke_Method(Object obj, IntPtr* args)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   --- End of inner exception stack trace ---
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at BenchmarkDotNet.Autogenerated.UniqueProgramName.AfterAssemblyLoadingAttached(String[] args) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 57
// AfterAll
No Workload Results were obtained from the run.
// Benchmark Process 1389975 has exited with code 255.

// ** Remained 7 (25.0%) benchmark(s) to run. Estimated finish 2026-01-27 23:45 (0h 7m from now) **
// **************************
// Benchmark: ProducerBenchmarks.'Dekaf: Single Message Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=1000, BatchSize=1000]
// *** Execute ***
// Launch: 1 / 1
// Execute: dotnet 8d2c821d-2520-4124-9cd5-dd795016bb32.dll --anonymousPipes 127 128 --benchmarkName "Dekaf.Benchmarks.ProducerBenchmarks.SingleProduce_Dekaf(MessageSize: 1000, BatchSize: 1000)" --job "InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3" --benchmarkId 21 in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/bin/Release/net10.0
// Failed to set up high priority (Permission denied). In order to run benchmarks with high priority, make sure you have the right permissions.
// BeforeAnythingElse

// Benchmark Process Environment Information:
// BenchmarkDotNet v0.14.0
// Runtime=.NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2
// GC=Concurrent Workstation
// HardwareIntrinsics=AVX2,AES,BMI1,BMI2,FMA,LZCNT,PCLMUL,POPCNT,AvxVnni,SERIALIZE VectorSize=256
// Job: Job-KXLAKW(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3)

Starting Kafka container via Testcontainers...
[testcontainers.org 00:00:00.08] Connected to Docker:
  Host: unix:///var/run/docker.sock
  Server Version: 29.2.0
  Kernel Version: 6.17.0-8-generic
  API Version: 1.53
  Operating System: Ubuntu 25.10
  Total Memory: 30.58 GB
[testcontainers.org 00:00:00.19] Docker container b8ebc3e8e27e created
[testcontainers.org 00:00:00.22] Start Docker container b8ebc3e8e27e
[testcontainers.org 00:00:00.32] Wait for Docker container b8ebc3e8e27e to complete readiness checks
[testcontainers.org 00:00:00.32] Docker container b8ebc3e8e27e ready
[testcontainers.org 00:00:02.39] Docker container 51b1d3aa1ae1 created
[testcontainers.org 00:00:02.40] Start Docker container 51b1d3aa1ae1
[testcontainers.org 00:00:02.54] Add file to tar archive: Content length: 390 byte(s), Target file: "/testcontainers.sh", UID: 0, GID: 0, Mode: 0755
[testcontainers.org 00:00:02.54] Copy tar archive to container: Content length: 390 byte(s), Docker container: 51b1d3aa1ae1
[testcontainers.org 00:00:02.55] Wait for Docker container 51b1d3aa1ae1 to complete readiness checks
[testcontainers.org 00:00:05.59] Docker container 51b1d3aa1ae1 ready
Kafka started at plaintext://127.0.0.1:32854/
Waiting for Kafka to be ready...
Kafka is ready with 1 broker(s)
[testcontainers.org 00:00:05.83] Execute "kafka-topics --bootstrap-server localhost:9092 --create --topic benchmark-producer --partitions 3 --replication-factor 1" at Docker container 51b1d3aa1ae1
Warning: Failed to create topic benchmark-producer: [2026-01-27 23:37:59,768] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:59,826] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:37:59,934] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:00,115] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:00,571] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:01,385] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:02,307] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:03,359] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:04,494] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:05,657] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:06,523] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:07,580] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:08,435] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:09,313] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:10,177] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:11,252] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:12,297] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:13,322] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:14,420] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:15,294] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:16,254] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:17,345] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:18,160] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:18,964] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:20,050] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:20,866] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:21,964] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:22,888] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:23,845] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:24,646] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:25,648] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:26,803] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:27,756] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:28,751] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:29,751] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:30,576] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:31,562] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:32,370] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:33,311] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:34,480] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:35,474] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:36,548] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:37,402] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:38,385] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:39,405] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:40,605] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:41,636] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:42,460] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:43,354] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:44,232] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:45,406] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:46,535] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:47,361] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:48,432] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:49,287] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:50,385] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:51,241] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:52,416] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:53,563] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:54,397] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:55,442] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:56,616] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:57,659] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:58,584] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:59,617] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32854) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:38:59,654] ERROR org.apache.kafka.common.errors.TimeoutException: Timed out waiting for a node assignment. Call: createTopics
 (kafka.admin.TopicCommand$)

System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.
 ---> System.InvalidOperationException: Failed to refresh metadata from any broker
   at Dekaf.Metadata.MetadataManager.RefreshMetadataInternalAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 278
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 218
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 204
   at Dekaf.Metadata.MetadataManager.InitializeAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 105
   at Dekaf.Producer.KafkaProducer`2.ProduceInternalAsync(ProducerMessage`2 message, PooledValueTaskSource`1 completion, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 970
   at Dekaf.Producer.KafkaProducer`2.ProcessWorkAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 950
   at Dekaf.Producer.PooledValueTaskSource`1.System.Threading.Tasks.Sources.IValueTaskSource<T>.GetResult(Int16 token) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/PooledValueTaskSource.cs:line 145
   at Dekaf.Producer.KafkaProducer`2.ProduceAsyncSlow(ProducerMessage`2 message, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 287
   at Dekaf.Benchmarks.ProducerBenchmarks.WarmupAsync() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 67
   at Dekaf.Benchmarks.ProducerBenchmarks.Setup() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 59
   at BenchmarkDotNet.Helpers.AwaitHelper.GetResult(Task task)
   at BenchmarkDotNet.Autogenerated.Runnable_21.<.ctor>b__3_0() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 3997
   at BenchmarkDotNet.Engines.EngineFactory.CreateReadyToRun(EngineParameters engineParameters)
   at BenchmarkDotNet.Autogenerated.Runnable_21.Run(IHost host, String benchmarkName) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 3981
   at System.Reflection.MethodBaseInvoker.InterpretedInvoke_Method(Object obj, IntPtr* args)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   --- End of inner exception stack trace ---
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at BenchmarkDotNet.Autogenerated.UniqueProgramName.AfterAssemblyLoadingAttached(String[] args) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 57
// AfterAll
No Workload Results were obtained from the run.
// Benchmark Process 1397178 has exited with code 255.

// ** Remained 6 (21.4%) benchmark(s) to run. Estimated finish 2026-01-27 23:45 (0h 6m from now) **
// **************************
// Benchmark: ProducerBenchmarks.'Confluent: Single Message Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=1000, BatchSize=1000]
// *** Execute ***
// Launch: 1 / 1
// Execute: dotnet 8d2c821d-2520-4124-9cd5-dd795016bb32.dll --anonymousPipes 127 128 --benchmarkName "Dekaf.Benchmarks.ProducerBenchmarks.SingleProduce_Confluent(MessageSize: 1000, BatchSize: 1000)" --job "InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3" --benchmarkId 22 in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/bin/Release/net10.0
// Failed to set up high priority (Permission denied). In order to run benchmarks with high priority, make sure you have the right permissions.
// BeforeAnythingElse

// Benchmark Process Environment Information:
// BenchmarkDotNet v0.14.0
// Runtime=.NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2
// GC=Concurrent Workstation
// HardwareIntrinsics=AVX2,AES,BMI1,BMI2,FMA,LZCNT,PCLMUL,POPCNT,AvxVnni,SERIALIZE VectorSize=256
// Job: Job-CHCIAF(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3)

Starting Kafka container via Testcontainers...
[testcontainers.org 00:00:00.08] Connected to Docker:
  Host: unix:///var/run/docker.sock
  Server Version: 29.2.0
  Kernel Version: 6.17.0-8-generic
  API Version: 1.53
  Operating System: Ubuntu 25.10
  Total Memory: 30.58 GB
[testcontainers.org 00:00:00.18] Docker container 0fe1f6540b0d created
[testcontainers.org 00:00:00.21] Start Docker container 0fe1f6540b0d
[testcontainers.org 00:00:00.29] Wait for Docker container 0fe1f6540b0d to complete readiness checks
[testcontainers.org 00:00:00.30] Docker container 0fe1f6540b0d ready
[testcontainers.org 00:00:02.36] Docker container ebf00c8df451 created
[testcontainers.org 00:00:02.36] Start Docker container ebf00c8df451
[testcontainers.org 00:00:02.49] Add file to tar archive: Content length: 390 byte(s), Target file: "/testcontainers.sh", UID: 0, GID: 0, Mode: 0755
[testcontainers.org 00:00:02.49] Copy tar archive to container: Content length: 390 byte(s), Docker container: ebf00c8df451
[testcontainers.org 00:00:02.50] Wait for Docker container ebf00c8df451 to complete readiness checks
[testcontainers.org 00:00:05.53] Docker container ebf00c8df451 ready
Kafka started at plaintext://127.0.0.1:32858/
Waiting for Kafka to be ready...
Kafka is ready with 1 broker(s)
[testcontainers.org 00:00:05.77] Execute "kafka-topics --bootstrap-server localhost:9092 --create --topic benchmark-producer --partitions 3 --replication-factor 1" at Docker container ebf00c8df451
Warning: Failed to create topic benchmark-producer: [2026-01-27 23:39:06,504] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:06,557] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:06,658] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:06,830] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:07,233] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:08,110] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:09,136] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:10,060] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:11,066] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:12,093] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:13,222] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:14,270] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:15,369] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:16,448] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:17,437] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:18,559] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:19,520] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:20,410] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:21,568] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:22,674] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:23,734] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:24,782] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:25,661] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:26,587] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:27,709] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:28,741] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:29,689] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:30,729] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:31,657] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:32,693] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:33,805] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:35,000] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:36,080] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:37,103] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:38,274] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:39,383] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:40,534] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:41,629] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:42,587] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:43,509] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:44,352] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:45,297] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:46,410] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:47,229] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:48,243] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:49,346] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:50,532] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:51,374] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:52,260] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:53,448] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:54,384] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:55,209] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:56,161] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:57,328] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:58,357] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:39:59,444] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:00,416] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:01,255] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:02,296] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:03,231] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:04,078] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:05,157] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:06,140] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32858) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:06,390] ERROR org.apache.kafka.common.errors.TimeoutException: Timed out waiting for a node assignment. Call: createTopics
 (kafka.admin.TopicCommand$)

System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.
 ---> System.InvalidOperationException: Failed to refresh metadata from any broker
   at Dekaf.Metadata.MetadataManager.RefreshMetadataInternalAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 278
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 218
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 204
   at Dekaf.Metadata.MetadataManager.InitializeAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 105
   at Dekaf.Producer.KafkaProducer`2.ProduceInternalAsync(ProducerMessage`2 message, PooledValueTaskSource`1 completion, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 970
   at Dekaf.Producer.KafkaProducer`2.ProcessWorkAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 950
   at Dekaf.Producer.PooledValueTaskSource`1.System.Threading.Tasks.Sources.IValueTaskSource<T>.GetResult(Int16 token) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/PooledValueTaskSource.cs:line 145
   at Dekaf.Producer.KafkaProducer`2.ProduceAsyncSlow(ProducerMessage`2 message, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 287
   at Dekaf.Benchmarks.ProducerBenchmarks.WarmupAsync() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 67
   at Dekaf.Benchmarks.ProducerBenchmarks.Setup() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 59
   at BenchmarkDotNet.Helpers.AwaitHelper.GetResult(Task task)
   at BenchmarkDotNet.Autogenerated.Runnable_22.<.ctor>b__3_0() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 4179
   at BenchmarkDotNet.Engines.EngineFactory.CreateReadyToRun(EngineParameters engineParameters)
   at BenchmarkDotNet.Autogenerated.Runnable_22.Run(IHost host, String benchmarkName) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 4163
   at System.Reflection.MethodBaseInvoker.InterpretedInvoke_Method(Object obj, IntPtr* args)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   --- End of inner exception stack trace ---
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at BenchmarkDotNet.Autogenerated.UniqueProgramName.AfterAssemblyLoadingAttached(String[] args) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 57
// AfterAll
No Workload Results were obtained from the run.
// Benchmark Process 1404049 has exited with code 255.

// ** Remained 5 (17.9%) benchmark(s) to run. Estimated finish 2026-01-27 23:45 (0h 5m from now) **
// **************************
// Benchmark: ProducerBenchmarks.'Dekaf: Batch Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=1000, BatchSize=1000]
// *** Execute ***
// Launch: 1 / 1
// Execute: dotnet 8d2c821d-2520-4124-9cd5-dd795016bb32.dll --anonymousPipes 127 128 --benchmarkName "Dekaf.Benchmarks.ProducerBenchmarks.BatchProduce_Dekaf(MessageSize: 1000, BatchSize: 1000)" --job "InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3" --benchmarkId 23 in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/bin/Release/net10.0
// Failed to set up high priority (Permission denied). In order to run benchmarks with high priority, make sure you have the right permissions.
// BeforeAnythingElse

// Benchmark Process Environment Information:
// BenchmarkDotNet v0.14.0
// Runtime=.NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2
// GC=Concurrent Workstation
// HardwareIntrinsics=AVX2,AES,BMI1,BMI2,FMA,LZCNT,PCLMUL,POPCNT,AvxVnni,SERIALIZE VectorSize=256
// Job: Job-BQSLZP(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3)

Starting Kafka container via Testcontainers...
[testcontainers.org 00:00:00.09] Connected to Docker:
  Host: unix:///var/run/docker.sock
  Server Version: 29.2.0
  Kernel Version: 6.17.0-8-generic
  API Version: 1.53
  Operating System: Ubuntu 25.10
  Total Memory: 30.58 GB
[testcontainers.org 00:00:00.21] Docker container 4820dbefb67e created
[testcontainers.org 00:00:00.23] Start Docker container 4820dbefb67e
[testcontainers.org 00:00:00.32] Wait for Docker container 4820dbefb67e to complete readiness checks
[testcontainers.org 00:00:00.33] Docker container 4820dbefb67e ready
[testcontainers.org 00:00:02.39] Docker container 73bdfb262ec6 created
[testcontainers.org 00:00:02.39] Start Docker container 73bdfb262ec6
[testcontainers.org 00:00:02.51] Add file to tar archive: Content length: 390 byte(s), Target file: "/testcontainers.sh", UID: 0, GID: 0, Mode: 0755
[testcontainers.org 00:00:02.51] Copy tar archive to container: Content length: 390 byte(s), Docker container: 73bdfb262ec6
[testcontainers.org 00:00:02.52] Wait for Docker container 73bdfb262ec6 to complete readiness checks
[testcontainers.org 00:00:05.55] Docker container 73bdfb262ec6 ready
Kafka started at plaintext://127.0.0.1:32862/
Waiting for Kafka to be ready...
Kafka is ready with 1 broker(s)
[testcontainers.org 00:00:05.79] Execute "kafka-topics --bootstrap-server localhost:9092 --create --topic benchmark-producer --partitions 3 --replication-factor 1" at Docker container 73bdfb262ec6
Warning: Failed to create topic benchmark-producer: [2026-01-27 23:40:13,238] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:13,294] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:13,394] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:13,620] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:14,080] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:14,944] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:16,006] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:16,886] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:17,785] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:18,793] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:19,843] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:21,032] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:22,082] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:22,905] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:23,966] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:24,948] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:25,894] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:26,878] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:27,853] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:29,017] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:30,103] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:30,994] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:32,104] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:33,266] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:34,377] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:35,183] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:36,338] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:37,493] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:38,308] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:39,211] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:40,104] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:40,957] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:41,808] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:42,825] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:43,729] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:44,772] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:45,952] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:46,955] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:48,031] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:48,905] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:49,719] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:50,857] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:51,732] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:52,882] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:53,686] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:54,494] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:55,652] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:56,619] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:57,638] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:58,792] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:40:59,655] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:00,635] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:01,784] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:02,924] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:03,825] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:04,704] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:05,694] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:06,503] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:07,551] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:08,462] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:09,267] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:10,088] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:10,924] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:11,839] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:12,813] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32862) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:13,119] ERROR org.apache.kafka.common.errors.TimeoutException: Timed out waiting for a node assignment. Call: createTopics
 (kafka.admin.TopicCommand$)

System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.
 ---> System.InvalidOperationException: Failed to refresh metadata from any broker
   at Dekaf.Metadata.MetadataManager.RefreshMetadataInternalAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 278
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 218
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 204
   at Dekaf.Metadata.MetadataManager.InitializeAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 105
   at Dekaf.Producer.KafkaProducer`2.ProduceInternalAsync(ProducerMessage`2 message, PooledValueTaskSource`1 completion, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 970
   at Dekaf.Producer.KafkaProducer`2.ProcessWorkAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 950
   at Dekaf.Producer.PooledValueTaskSource`1.System.Threading.Tasks.Sources.IValueTaskSource<T>.GetResult(Int16 token) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/PooledValueTaskSource.cs:line 145
   at Dekaf.Producer.KafkaProducer`2.ProduceAsyncSlow(ProducerMessage`2 message, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 287
   at Dekaf.Benchmarks.ProducerBenchmarks.WarmupAsync() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 67
   at Dekaf.Benchmarks.ProducerBenchmarks.Setup() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 59
   at BenchmarkDotNet.Helpers.AwaitHelper.GetResult(Task task)
   at BenchmarkDotNet.Autogenerated.Runnable_23.<.ctor>b__3_0() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 4350
   at BenchmarkDotNet.Engines.EngineFactory.CreateReadyToRun(EngineParameters engineParameters)
   at BenchmarkDotNet.Autogenerated.Runnable_23.Run(IHost host, String benchmarkName) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 4334
   at System.Reflection.MethodBaseInvoker.InterpretedInvoke_Method(Object obj, IntPtr* args)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   --- End of inner exception stack trace ---
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at BenchmarkDotNet.Autogenerated.UniqueProgramName.AfterAssemblyLoadingAttached(String[] args) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 57
// AfterAll
No Workload Results were obtained from the run.
// Benchmark Process 1411291 has exited with code 255.

// ** Remained 4 (14.3%) benchmark(s) to run. Estimated finish 2026-01-27 23:45 (0h 4m from now) **
// **************************
// Benchmark: ProducerBenchmarks.'Confluent: Batch Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=1000, BatchSize=1000]
// *** Execute ***
// Launch: 1 / 1
// Execute: dotnet 8d2c821d-2520-4124-9cd5-dd795016bb32.dll --anonymousPipes 127 128 --benchmarkName "Dekaf.Benchmarks.ProducerBenchmarks.BatchProduce_Confluent(MessageSize: 1000, BatchSize: 1000)" --job "InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3" --benchmarkId 24 in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/bin/Release/net10.0
// Failed to set up high priority (Permission denied). In order to run benchmarks with high priority, make sure you have the right permissions.
// BeforeAnythingElse

// Benchmark Process Environment Information:
// BenchmarkDotNet v0.14.0
// Runtime=.NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2
// GC=Concurrent Workstation
// HardwareIntrinsics=AVX2,AES,BMI1,BMI2,FMA,LZCNT,PCLMUL,POPCNT,AvxVnni,SERIALIZE VectorSize=256
// Job: Job-NMBSZK(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3)

Starting Kafka container via Testcontainers...
[testcontainers.org 00:00:00.08] Connected to Docker:
  Host: unix:///var/run/docker.sock
  Server Version: 29.2.0
  Kernel Version: 6.17.0-8-generic
  API Version: 1.53
  Operating System: Ubuntu 25.10
  Total Memory: 30.58 GB
[testcontainers.org 00:00:00.19] Docker container ad2e6ed1b685 created
[testcontainers.org 00:00:00.21] Start Docker container ad2e6ed1b685
[testcontainers.org 00:00:00.32] Wait for Docker container ad2e6ed1b685 to complete readiness checks
[testcontainers.org 00:00:00.32] Docker container ad2e6ed1b685 ready
[testcontainers.org 00:00:02.40] Docker container 199006b9503a created
[testcontainers.org 00:00:02.40] Start Docker container 199006b9503a
[testcontainers.org 00:00:02.51] Add file to tar archive: Content length: 390 byte(s), Target file: "/testcontainers.sh", UID: 0, GID: 0, Mode: 0755
[testcontainers.org 00:00:02.52] Copy tar archive to container: Content length: 390 byte(s), Docker container: 199006b9503a
[testcontainers.org 00:00:02.52] Wait for Docker container 199006b9503a to complete readiness checks
[testcontainers.org 00:00:05.56] Docker container 199006b9503a ready
Kafka started at plaintext://127.0.0.1:32866/
Waiting for Kafka to be ready...
Kafka is ready with 1 broker(s)
[testcontainers.org 00:00:05.80] Execute "kafka-topics --bootstrap-server localhost:9092 --create --topic benchmark-producer --partitions 3 --replication-factor 1" at Docker container 199006b9503a
Warning: Failed to create topic benchmark-producer: [2026-01-27 23:41:20,012] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:20,067] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:20,160] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:20,363] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:20,821] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:21,542] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:22,395] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:23,506] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:24,499] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:25,650] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:26,601] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:27,616] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:28,677] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:29,656] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:30,569] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:31,494] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:32,681] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:33,786] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:34,744] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:35,819] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:36,793] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:37,619] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:38,595] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:39,587] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:40,764] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:41,736] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:42,608] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:43,607] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:44,717] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:45,523] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:46,325] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:47,422] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:48,486] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:49,315] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:50,208] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:51,340] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:52,459] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:53,335] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:54,456] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:55,283] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:56,205] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:57,266] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:58,113] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:41:59,198] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:00,298] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:01,180] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:02,115] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:02,969] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:04,016] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:04,929] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:05,956] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:07,134] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:08,143] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:09,284] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:10,232] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:11,366] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:12,447] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:13,462] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:14,543] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:15,375] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:16,355] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:17,471] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:18,581] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:19,387] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32866) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:19,898] ERROR org.apache.kafka.common.errors.TimeoutException: Timed out waiting for a node assignment. Call: createTopics
 (kafka.admin.TopicCommand$)

System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.
 ---> System.InvalidOperationException: Failed to refresh metadata from any broker
   at Dekaf.Metadata.MetadataManager.RefreshMetadataInternalAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 278
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 218
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 204
   at Dekaf.Metadata.MetadataManager.InitializeAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 105
   at Dekaf.Producer.KafkaProducer`2.ProduceInternalAsync(ProducerMessage`2 message, PooledValueTaskSource`1 completion, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 970
   at Dekaf.Producer.KafkaProducer`2.ProcessWorkAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 950
   at Dekaf.Producer.PooledValueTaskSource`1.System.Threading.Tasks.Sources.IValueTaskSource<T>.GetResult(Int16 token) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/PooledValueTaskSource.cs:line 145
   at Dekaf.Producer.KafkaProducer`2.ProduceAsyncSlow(ProducerMessage`2 message, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 287
   at Dekaf.Benchmarks.ProducerBenchmarks.WarmupAsync() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 67
   at Dekaf.Benchmarks.ProducerBenchmarks.Setup() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 59
   at BenchmarkDotNet.Helpers.AwaitHelper.GetResult(Task task)
   at BenchmarkDotNet.Autogenerated.Runnable_24.<.ctor>b__3_0() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 4516
   at BenchmarkDotNet.Engines.EngineFactory.CreateReadyToRun(EngineParameters engineParameters)
   at BenchmarkDotNet.Autogenerated.Runnable_24.Run(IHost host, String benchmarkName) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 4500
   at System.Reflection.MethodBaseInvoker.InterpretedInvoke_Method(Object obj, IntPtr* args)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   --- End of inner exception stack trace ---
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at BenchmarkDotNet.Autogenerated.UniqueProgramName.AfterAssemblyLoadingAttached(String[] args) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 57
// AfterAll
No Workload Results were obtained from the run.
// Benchmark Process 1418344 has exited with code 255.

// ** Remained 3 (10.7%) benchmark(s) to run. Estimated finish 2026-01-27 23:45 (0h 3m from now) **
// **************************
// Benchmark: ProducerBenchmarks.'Dekaf: Fire-and-Forget Send': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=1000, BatchSize=1000]
// *** Execute ***
// Launch: 1 / 1
// Execute: dotnet 8d2c821d-2520-4124-9cd5-dd795016bb32.dll --anonymousPipes 127 128 --benchmarkName "Dekaf.Benchmarks.ProducerBenchmarks.FireAndForget_Dekaf(MessageSize: 1000, BatchSize: 1000)" --job "IterationCount=10, RunStrategy=Throughput, WarmupCount=3" --benchmarkId 25 in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/bin/Release/net10.0
// Failed to set up high priority (Permission denied). In order to run benchmarks with high priority, make sure you have the right permissions.
// BeforeAnythingElse

// Benchmark Process Environment Information:
// BenchmarkDotNet v0.14.0
// Runtime=.NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2
// GC=Concurrent Workstation
// HardwareIntrinsics=AVX2,AES,BMI1,BMI2,FMA,LZCNT,PCLMUL,POPCNT,AvxVnni,SERIALIZE VectorSize=256
// Job: Job-UHIZKN(IterationCount=10, RunStrategy=Throughput, WarmupCount=3)

Starting Kafka container via Testcontainers...
[testcontainers.org 00:00:00.08] Connected to Docker:
  Host: unix:///var/run/docker.sock
  Server Version: 29.2.0
  Kernel Version: 6.17.0-8-generic
  API Version: 1.53
  Operating System: Ubuntu 25.10
  Total Memory: 30.58 GB
[testcontainers.org 00:00:00.19] Docker container eb78f83735d6 created
[testcontainers.org 00:00:00.21] Start Docker container eb78f83735d6
[testcontainers.org 00:00:00.31] Wait for Docker container eb78f83735d6 to complete readiness checks
[testcontainers.org 00:00:00.32] Docker container eb78f83735d6 ready
[testcontainers.org 00:00:02.41] Docker container d1882e9aa5a2 created
[testcontainers.org 00:00:02.42] Start Docker container d1882e9aa5a2
[testcontainers.org 00:00:02.53] Add file to tar archive: Content length: 390 byte(s), Target file: "/testcontainers.sh", UID: 0, GID: 0, Mode: 0755
[testcontainers.org 00:00:02.54] Copy tar archive to container: Content length: 390 byte(s), Docker container: d1882e9aa5a2
[testcontainers.org 00:00:02.54] Wait for Docker container d1882e9aa5a2 to complete readiness checks
[testcontainers.org 00:00:05.58] Docker container d1882e9aa5a2 ready
Kafka started at plaintext://127.0.0.1:32870/
Waiting for Kafka to be ready...
Kafka is ready with 1 broker(s)
[testcontainers.org 00:00:05.81] Execute "kafka-topics --bootstrap-server localhost:9092 --create --topic benchmark-producer --partitions 3 --replication-factor 1" at Docker container d1882e9aa5a2
Warning: Failed to create topic benchmark-producer: [2026-01-27 23:42:26,759] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:26,800] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:26,903] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:27,104] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:27,483] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:28,288] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:29,425] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:30,357] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:31,204] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:32,122] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:33,227] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:34,135] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:35,065] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:36,244] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:37,167] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:38,274] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:39,256] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:40,342] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:41,394] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:42,483] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:43,351] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:44,236] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:45,414] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:46,583] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:47,657] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:48,576] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:49,526] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:50,623] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:51,538] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:52,677] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:53,813] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:54,669] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:55,804] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:56,855] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:57,938] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:42:58,893] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:00,030] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:00,918] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:02,051] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:03,062] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:04,191] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:05,120] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:05,926] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:06,848] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:07,844] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:08,960] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:09,908] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:11,075] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:12,243] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:13,324] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:14,322] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:15,427] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:16,573] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:17,428] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:18,366] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:19,270] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:20,424] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:21,598] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:22,613] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:23,612] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:24,775] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:25,912] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32870) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:26,646] ERROR org.apache.kafka.common.errors.TimeoutException: Timed out waiting for a node assignment. Call: createTopics
 (kafka.admin.TopicCommand$)

System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.
 ---> System.InvalidOperationException: Failed to refresh metadata from any broker
   at Dekaf.Metadata.MetadataManager.RefreshMetadataInternalAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 278
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 218
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 204
   at Dekaf.Metadata.MetadataManager.InitializeAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 105
   at Dekaf.Producer.KafkaProducer`2.ProduceInternalAsync(ProducerMessage`2 message, PooledValueTaskSource`1 completion, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 970
   at Dekaf.Producer.KafkaProducer`2.ProcessWorkAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 950
   at Dekaf.Producer.PooledValueTaskSource`1.System.Threading.Tasks.Sources.IValueTaskSource<T>.GetResult(Int16 token) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/PooledValueTaskSource.cs:line 145
   at Dekaf.Producer.KafkaProducer`2.ProduceAsyncSlow(ProducerMessage`2 message, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 287
   at Dekaf.Benchmarks.ProducerBenchmarks.WarmupAsync() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 67
   at Dekaf.Benchmarks.ProducerBenchmarks.Setup() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 59
   at BenchmarkDotNet.Helpers.AwaitHelper.GetResult(Task task)
   at BenchmarkDotNet.Autogenerated.Runnable_25.<.ctor>b__3_0() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 4680
   at BenchmarkDotNet.Engines.EngineFactory.CreateReadyToRun(EngineParameters engineParameters)
   at BenchmarkDotNet.Autogenerated.Runnable_25.Run(IHost host, String benchmarkName) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 4664
   at System.Reflection.MethodBaseInvoker.InterpretedInvoke_Method(Object obj, IntPtr* args)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   --- End of inner exception stack trace ---
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at BenchmarkDotNet.Autogenerated.UniqueProgramName.AfterAssemblyLoadingAttached(String[] args) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 57
// AfterAll
No Workload Results were obtained from the run.
// Benchmark Process 1425139 has exited with code 255.

// ** Remained 2 (7.1%) benchmark(s) to run. Estimated finish 2026-01-27 23:45 (0h 2m from now) **
// **************************
// Benchmark: ProducerBenchmarks.'Dekaf: Fire-and-Forget Direct': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=1000, BatchSize=1000]
// *** Execute ***
// Launch: 1 / 1
// Execute: dotnet 8d2c821d-2520-4124-9cd5-dd795016bb32.dll --anonymousPipes 127 128 --benchmarkName "Dekaf.Benchmarks.ProducerBenchmarks.FireAndForget_Dekaf_Direct(MessageSize: 1000, BatchSize: 1000)" --job "IterationCount=10, RunStrategy=Throughput, WarmupCount=3" --benchmarkId 26 in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/bin/Release/net10.0
// Failed to set up high priority (Permission denied). In order to run benchmarks with high priority, make sure you have the right permissions.
// BeforeAnythingElse

// Benchmark Process Environment Information:
// BenchmarkDotNet v0.14.0
// Runtime=.NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2
// GC=Concurrent Workstation
// HardwareIntrinsics=AVX2,AES,BMI1,BMI2,FMA,LZCNT,PCLMUL,POPCNT,AvxVnni,SERIALIZE VectorSize=256
// Job: Job-AAXSMM(IterationCount=10, RunStrategy=Throughput, WarmupCount=3)

Starting Kafka container via Testcontainers...
[testcontainers.org 00:00:00.08] Connected to Docker:
  Host: unix:///var/run/docker.sock
  Server Version: 29.2.0
  Kernel Version: 6.17.0-8-generic
  API Version: 1.53
  Operating System: Ubuntu 25.10
  Total Memory: 30.58 GB
[testcontainers.org 00:00:00.23] Docker container a10a50becd44 created
[testcontainers.org 00:00:00.25] Start Docker container a10a50becd44
[testcontainers.org 00:00:00.35] Wait for Docker container a10a50becd44 to complete readiness checks
[testcontainers.org 00:00:00.35] Docker container a10a50becd44 ready
[testcontainers.org 00:00:02.43] Docker container fb5085ca4bdf created
[testcontainers.org 00:00:02.43] Start Docker container fb5085ca4bdf
[testcontainers.org 00:00:02.55] Add file to tar archive: Content length: 390 byte(s), Target file: "/testcontainers.sh", UID: 0, GID: 0, Mode: 0755
[testcontainers.org 00:00:02.55] Copy tar archive to container: Content length: 390 byte(s), Docker container: fb5085ca4bdf
[testcontainers.org 00:00:02.56] Wait for Docker container fb5085ca4bdf to complete readiness checks
[testcontainers.org 00:00:05.60] Docker container fb5085ca4bdf ready
Kafka started at plaintext://127.0.0.1:32874/
Waiting for Kafka to be ready...
Kafka is ready with 1 broker(s)
[testcontainers.org 00:00:05.84] Execute "kafka-topics --bootstrap-server localhost:9092 --create --topic benchmark-producer --partitions 3 --replication-factor 1" at Docker container fb5085ca4bdf
Warning: Failed to create topic benchmark-producer: [2026-01-27 23:43:33,547] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:33,589] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:33,686] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:33,892] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:34,252] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:34,975] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:36,092] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:37,061] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:38,105] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:39,247] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:40,386] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:41,499] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:42,471] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:43,325] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:44,151] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:45,228] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:46,094] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:46,983] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:48,029] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:49,023] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:50,111] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:50,998] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:51,944] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:52,755] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:53,766] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:54,611] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:55,703] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:56,678] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:57,720] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:58,867] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:43:59,820] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:00,747] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:01,824] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:03,007] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:03,836] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:05,031] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:05,978] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:07,093] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:08,024] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:09,115] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:09,982] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:10,920] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:12,102] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:13,215] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:14,088] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:14,946] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:16,042] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:17,148] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:18,079] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:18,911] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:20,073] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:21,007] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:22,176] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:22,976] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:24,143] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:25,265] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:26,363] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:27,252] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:28,298] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:29,130] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:30,039] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:30,958] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:32,077] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:33,155] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32874) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:33,440] ERROR org.apache.kafka.common.errors.TimeoutException: Timed out waiting for a node assignment. Call: createTopics
 (kafka.admin.TopicCommand$)

System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.
 ---> System.InvalidOperationException: Failed to refresh metadata from any broker
   at Dekaf.Metadata.MetadataManager.RefreshMetadataInternalAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 278
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 218
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 204
   at Dekaf.Metadata.MetadataManager.InitializeAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 105
   at Dekaf.Producer.KafkaProducer`2.ProduceInternalAsync(ProducerMessage`2 message, PooledValueTaskSource`1 completion, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 970
   at Dekaf.Producer.KafkaProducer`2.ProcessWorkAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 950
   at Dekaf.Producer.PooledValueTaskSource`1.System.Threading.Tasks.Sources.IValueTaskSource<T>.GetResult(Int16 token) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/PooledValueTaskSource.cs:line 145
   at Dekaf.Producer.KafkaProducer`2.ProduceAsyncSlow(ProducerMessage`2 message, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 287
   at Dekaf.Benchmarks.ProducerBenchmarks.WarmupAsync() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 67
   at Dekaf.Benchmarks.ProducerBenchmarks.Setup() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 59
   at BenchmarkDotNet.Helpers.AwaitHelper.GetResult(Task task)
   at BenchmarkDotNet.Autogenerated.Runnable_26.<.ctor>b__3_0() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 4874
   at BenchmarkDotNet.Engines.EngineFactory.CreateReadyToRun(EngineParameters engineParameters)
   at BenchmarkDotNet.Autogenerated.Runnable_26.Run(IHost host, String benchmarkName) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 4858
   at System.Reflection.MethodBaseInvoker.InterpretedInvoke_Method(Object obj, IntPtr* args)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   --- End of inner exception stack trace ---
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at BenchmarkDotNet.Autogenerated.UniqueProgramName.AfterAssemblyLoadingAttached(String[] args) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 57
// AfterAll
No Workload Results were obtained from the run.
// Benchmark Process 1431916 has exited with code 255.

// ** Remained 1 (3.6%) benchmark(s) to run. Estimated finish 2026-01-27 23:45 (0h 1m from now) **
// **************************
// Benchmark: ProducerBenchmarks.'Confluent: Fire-and-Forget Produce': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=1000, BatchSize=1000]
// *** Execute ***
// Launch: 1 / 1
// Execute: dotnet 8d2c821d-2520-4124-9cd5-dd795016bb32.dll --anonymousPipes 127 128 --benchmarkName "Dekaf.Benchmarks.ProducerBenchmarks.FireAndForget_Confluent(MessageSize: 1000, BatchSize: 1000)" --job "IterationCount=10, RunStrategy=Throughput, WarmupCount=3" --benchmarkId 27 in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/bin/Release/net10.0
// Failed to set up high priority (Permission denied). In order to run benchmarks with high priority, make sure you have the right permissions.
// BeforeAnythingElse

// Benchmark Process Environment Information:
// BenchmarkDotNet v0.14.0
// Runtime=.NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2
// GC=Concurrent Workstation
// HardwareIntrinsics=AVX2,AES,BMI1,BMI2,FMA,LZCNT,PCLMUL,POPCNT,AvxVnni,SERIALIZE VectorSize=256
// Job: Job-NPCGSI(IterationCount=10, RunStrategy=Throughput, WarmupCount=3)

Starting Kafka container via Testcontainers...
[testcontainers.org 00:00:00.08] Connected to Docker:
  Host: unix:///var/run/docker.sock
  Server Version: 29.2.0
  Kernel Version: 6.17.0-8-generic
  API Version: 1.53
  Operating System: Ubuntu 25.10
  Total Memory: 30.58 GB
[testcontainers.org 00:00:00.20] Docker container 2b1abe1e2555 created
[testcontainers.org 00:00:00.22] Start Docker container 2b1abe1e2555
[testcontainers.org 00:00:00.33] Wait for Docker container 2b1abe1e2555 to complete readiness checks
[testcontainers.org 00:00:00.33] Docker container 2b1abe1e2555 ready
[testcontainers.org 00:00:02.40] Docker container c69a78e801af created
[testcontainers.org 00:00:02.40] Start Docker container c69a78e801af
[testcontainers.org 00:00:02.52] Add file to tar archive: Content length: 390 byte(s), Target file: "/testcontainers.sh", UID: 0, GID: 0, Mode: 0755
[testcontainers.org 00:00:02.52] Copy tar archive to container: Content length: 390 byte(s), Docker container: c69a78e801af
[testcontainers.org 00:00:02.53] Wait for Docker container c69a78e801af to complete readiness checks
[testcontainers.org 00:00:05.57] Docker container c69a78e801af ready
Kafka started at plaintext://127.0.0.1:32878/
Waiting for Kafka to be ready...
Kafka is ready with 1 broker(s)
[testcontainers.org 00:00:05.81] Execute "kafka-topics --bootstrap-server localhost:9092 --create --topic benchmark-producer --partitions 3 --replication-factor 1" at Docker container c69a78e801af
Warning: Failed to create topic benchmark-producer: [2026-01-27 23:44:40,301] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:40,343] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:40,440] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:40,670] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:41,023] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:41,788] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:42,921] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:43,963] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:44,949] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:45,850] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:47,043] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:48,001] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:48,995] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:49,993] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:51,098] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:51,900] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:52,721] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:53,659] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:54,833] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:55,756] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:56,654] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:57,632] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:58,816] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:44:59,800] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:00,626] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:01,812] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:02,957] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:03,790] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:04,857] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:05,850] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:06,937] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:07,950] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:08,900] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:10,098] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:10,925] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:11,860] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:12,898] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:14,001] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:15,168] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:16,029] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:17,016] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:18,176] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:19,198] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:20,030] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:21,143] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:22,110] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:23,076] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:24,158] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:24,999] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:25,813] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:26,680] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:27,711] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:28,597] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:29,410] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:30,296] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:31,458] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:32,507] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:33,491] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:34,673] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:35,847] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:36,692] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:37,588] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:38,556] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:39,606] WARN [AdminClient clientId=adminclient-1] Connection to node 1 (/127.0.0.1:32878) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
[2026-01-27 23:45:40,191] ERROR org.apache.kafka.common.errors.TimeoutException: Timed out waiting for a node assignment. Call: createTopics
 (kafka.admin.TopicCommand$)

System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.
 ---> System.InvalidOperationException: Failed to refresh metadata from any broker
   at Dekaf.Metadata.MetadataManager.RefreshMetadataInternalAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 278
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(IEnumerable`1 topics, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 218
   at Dekaf.Metadata.MetadataManager.RefreshMetadataAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 204
   at Dekaf.Metadata.MetadataManager.InitializeAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Metadata/MetadataManager.cs:line 105
   at Dekaf.Producer.KafkaProducer`2.ProduceInternalAsync(ProducerMessage`2 message, PooledValueTaskSource`1 completion, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 970
   at Dekaf.Producer.KafkaProducer`2.ProcessWorkAsync(CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 950
   at Dekaf.Producer.PooledValueTaskSource`1.System.Threading.Tasks.Sources.IValueTaskSource<T>.GetResult(Int16 token) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/PooledValueTaskSource.cs:line 145
   at Dekaf.Producer.KafkaProducer`2.ProduceAsyncSlow(ProducerMessage`2 message, CancellationToken cancellationToken) in /home/tom-longhurst/dev/Dekaf/src/Dekaf/Producer/KafkaProducer.cs:line 287
   at Dekaf.Benchmarks.ProducerBenchmarks.WarmupAsync() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 67
   at Dekaf.Benchmarks.ProducerBenchmarks.Setup() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/ProducerBenchmarks.cs:line 59
   at BenchmarkDotNet.Helpers.AwaitHelper.GetResult(Task task)
   at BenchmarkDotNet.Autogenerated.Runnable_27.<.ctor>b__3_0() in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 5068
   at BenchmarkDotNet.Engines.EngineFactory.CreateReadyToRun(EngineParameters engineParameters)
   at BenchmarkDotNet.Autogenerated.Runnable_27.Run(IHost host, String benchmarkName) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 5052
   at System.Reflection.MethodBaseInvoker.InterpretedInvoke_Method(Object obj, IntPtr* args)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   --- End of inner exception stack trace ---
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at BenchmarkDotNet.Autogenerated.UniqueProgramName.AfterAssemblyLoadingAttached(String[] args) in /home/tom-longhurst/dev/Dekaf/tools/Dekaf.Benchmarks/bin/Release/net10.0/8d2c821d-2520-4124-9cd5-dd795016bb32/8d2c821d-2520-4124-9cd5-dd795016bb32.notcs:line 57
// AfterAll
No Workload Results were obtained from the run.
// Benchmark Process 1438658 has exited with code 255.

// ** Remained 0 (0.0%) benchmark(s) to run. Estimated finish 2026-01-27 23:45 (0h 0m from now) **
// ***** BenchmarkRunner: Finish  *****

// * Export *
  BenchmarkDotNet.Artifacts/results/Dekaf.Benchmarks.ProducerBenchmarks-report.csv
  BenchmarkDotNet.Artifacts/results/Dekaf.Benchmarks.ProducerBenchmarks-report-github.md
  BenchmarkDotNet.Artifacts/results/Dekaf.Benchmarks.ProducerBenchmarks-report.html

// * Detailed results *
ProducerBenchmarks.'Dekaf: Single Message Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=100, BatchSize=100]
Runtime = .NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2; GC = Concurrent Workstation
There are not any results runs

ProducerBenchmarks.'Confluent: Single Message Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=100, BatchSize=100]
Runtime = .NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2; GC = Concurrent Workstation
There are not any results runs

ProducerBenchmarks.'Dekaf: Batch Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=100, BatchSize=100]
Runtime = .NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2; GC = Concurrent Workstation
There are not any results runs

ProducerBenchmarks.'Confluent: Batch Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=100, BatchSize=100]
Runtime = .NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2; GC = Concurrent Workstation
There are not any results runs

ProducerBenchmarks.'Dekaf: Fire-and-Forget Send': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=100, BatchSize=100]
Runtime = .NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2; GC = Concurrent Workstation
There are not any results runs

ProducerBenchmarks.'Dekaf: Fire-and-Forget Direct': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=100, BatchSize=100]
Runtime = .NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2; GC = Concurrent Workstation
There are not any results runs

ProducerBenchmarks.'Confluent: Fire-and-Forget Produce': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=100, BatchSize=100]
Runtime = .NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2; GC = Concurrent Workstation
There are not any results runs

ProducerBenchmarks.'Dekaf: Single Message Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=100, BatchSize=1000]
Runtime = .NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2; GC = Concurrent Workstation
There are not any results runs

ProducerBenchmarks.'Confluent: Single Message Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=100, BatchSize=1000]
Runtime = .NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2; GC = Concurrent Workstation
There are not any results runs

ProducerBenchmarks.'Dekaf: Batch Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=100, BatchSize=1000]
Runtime = .NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2; GC = Concurrent Workstation
There are not any results runs

ProducerBenchmarks.'Confluent: Batch Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=100, BatchSize=1000]
Runtime = .NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2; GC = Concurrent Workstation
There are not any results runs

ProducerBenchmarks.'Dekaf: Fire-and-Forget Send': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=100, BatchSize=1000]
Runtime = .NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2; GC = Concurrent Workstation
There are not any results runs

ProducerBenchmarks.'Dekaf: Fire-and-Forget Direct': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=100, BatchSize=1000]
Runtime = .NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2; GC = Concurrent Workstation
There are not any results runs

ProducerBenchmarks.'Confluent: Fire-and-Forget Produce': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=100, BatchSize=1000]
Runtime = .NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2; GC = Concurrent Workstation
There are not any results runs

ProducerBenchmarks.'Dekaf: Single Message Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=1000, BatchSize=100]
Runtime = .NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2; GC = Concurrent Workstation
There are not any results runs

ProducerBenchmarks.'Confluent: Single Message Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=1000, BatchSize=100]
Runtime = .NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2; GC = Concurrent Workstation
There are not any results runs

ProducerBenchmarks.'Dekaf: Batch Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=1000, BatchSize=100]
Runtime = .NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2; GC = Concurrent Workstation
There are not any results runs

ProducerBenchmarks.'Confluent: Batch Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=1000, BatchSize=100]
Runtime = .NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2; GC = Concurrent Workstation
There are not any results runs

ProducerBenchmarks.'Dekaf: Fire-and-Forget Send': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=1000, BatchSize=100]
Runtime = .NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2; GC = Concurrent Workstation
There are not any results runs

ProducerBenchmarks.'Dekaf: Fire-and-Forget Direct': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=1000, BatchSize=100]
Runtime = .NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2; GC = Concurrent Workstation
There are not any results runs

ProducerBenchmarks.'Confluent: Fire-and-Forget Produce': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=1000, BatchSize=100]
Runtime = .NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2; GC = Concurrent Workstation
There are not any results runs

ProducerBenchmarks.'Dekaf: Single Message Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=1000, BatchSize=1000]
Runtime = .NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2; GC = Concurrent Workstation
There are not any results runs

ProducerBenchmarks.'Confluent: Single Message Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=1000, BatchSize=1000]
Runtime = .NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2; GC = Concurrent Workstation
There are not any results runs

ProducerBenchmarks.'Dekaf: Batch Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=1000, BatchSize=1000]
Runtime = .NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2; GC = Concurrent Workstation
There are not any results runs

ProducerBenchmarks.'Confluent: Batch Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=1000, BatchSize=1000]
Runtime = .NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2; GC = Concurrent Workstation
There are not any results runs

ProducerBenchmarks.'Dekaf: Fire-and-Forget Send': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=1000, BatchSize=1000]
Runtime = .NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2; GC = Concurrent Workstation
There are not any results runs

ProducerBenchmarks.'Dekaf: Fire-and-Forget Direct': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=1000, BatchSize=1000]
Runtime = .NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2; GC = Concurrent Workstation
There are not any results runs

ProducerBenchmarks.'Confluent: Fire-and-Forget Produce': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=1000, BatchSize=1000]
Runtime = .NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2; GC = Concurrent Workstation
There are not any results runs

// * Summary *

BenchmarkDotNet v0.14.0, Ubuntu 25.10 (Questing Quokka)
12th Gen Intel Core i7-12700K, 1 CPU, 20 logical and 12 physical cores
.NET SDK 10.0.100
  [Host]     : .NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2
  Job-XAIQOV : .NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2
  Job-FNUAAK : .NET 10.0.0 (10.0.25.52411), X64 RyuJIT AVX2

IterationCount=10  RunStrategy=Throughput  WarmupCount=3  

| Method                               | Job        | InvocationCount | UnrollFactor | MessageSize | BatchSize | Mean | Error |
|------------------------------------- |----------- |---------------- |------------- |------------ |---------- |-----:|------:|
| 'Dekaf: Single Message Produce'      | Job-XAIQOV | 1               | 1            | 100         | 100       |   NA |    NA |
| 'Confluent: Single Message Produce'  | Job-XAIQOV | 1               | 1            | 100         | 100       |   NA |    NA |
| 'Dekaf: Batch Produce'               | Job-XAIQOV | 1               | 1            | 100         | 100       |   NA |    NA |
| 'Confluent: Batch Produce'           | Job-XAIQOV | 1               | 1            | 100         | 100       |   NA |    NA |
| 'Dekaf: Fire-and-Forget Send'        | Job-FNUAAK | Default         | 16           | 100         | 100       |   NA |    NA |
| 'Dekaf: Fire-and-Forget Direct'      | Job-FNUAAK | Default         | 16           | 100         | 100       |   NA |    NA |
| 'Confluent: Fire-and-Forget Produce' | Job-FNUAAK | Default         | 16           | 100         | 100       |   NA |    NA |
| 'Dekaf: Single Message Produce'      | Job-XAIQOV | 1               | 1            | 100         | 1000      |   NA |    NA |
| 'Confluent: Single Message Produce'  | Job-XAIQOV | 1               | 1            | 100         | 1000      |   NA |    NA |
| 'Dekaf: Batch Produce'               | Job-XAIQOV | 1               | 1            | 100         | 1000      |   NA |    NA |
| 'Confluent: Batch Produce'           | Job-XAIQOV | 1               | 1            | 100         | 1000      |   NA |    NA |
| 'Dekaf: Fire-and-Forget Send'        | Job-FNUAAK | Default         | 16           | 100         | 1000      |   NA |    NA |
| 'Dekaf: Fire-and-Forget Direct'      | Job-FNUAAK | Default         | 16           | 100         | 1000      |   NA |    NA |
| 'Confluent: Fire-and-Forget Produce' | Job-FNUAAK | Default         | 16           | 100         | 1000      |   NA |    NA |
| 'Dekaf: Single Message Produce'      | Job-XAIQOV | 1               | 1            | 1000        | 100       |   NA |    NA |
| 'Confluent: Single Message Produce'  | Job-XAIQOV | 1               | 1            | 1000        | 100       |   NA |    NA |
| 'Dekaf: Batch Produce'               | Job-XAIQOV | 1               | 1            | 1000        | 100       |   NA |    NA |
| 'Confluent: Batch Produce'           | Job-XAIQOV | 1               | 1            | 1000        | 100       |   NA |    NA |
| 'Dekaf: Fire-and-Forget Send'        | Job-FNUAAK | Default         | 16           | 1000        | 100       |   NA |    NA |
| 'Dekaf: Fire-and-Forget Direct'      | Job-FNUAAK | Default         | 16           | 1000        | 100       |   NA |    NA |
| 'Confluent: Fire-and-Forget Produce' | Job-FNUAAK | Default         | 16           | 1000        | 100       |   NA |    NA |
| 'Dekaf: Single Message Produce'      | Job-XAIQOV | 1               | 1            | 1000        | 1000      |   NA |    NA |
| 'Confluent: Single Message Produce'  | Job-XAIQOV | 1               | 1            | 1000        | 1000      |   NA |    NA |
| 'Dekaf: Batch Produce'               | Job-XAIQOV | 1               | 1            | 1000        | 1000      |   NA |    NA |
| 'Confluent: Batch Produce'           | Job-XAIQOV | 1               | 1            | 1000        | 1000      |   NA |    NA |
| 'Dekaf: Fire-and-Forget Send'        | Job-FNUAAK | Default         | 16           | 1000        | 1000      |   NA |    NA |
| 'Dekaf: Fire-and-Forget Direct'      | Job-FNUAAK | Default         | 16           | 1000        | 1000      |   NA |    NA |
| 'Confluent: Fire-and-Forget Produce' | Job-FNUAAK | Default         | 16           | 1000        | 1000      |   NA |    NA |

Benchmarks with issues:
  ProducerBenchmarks.'Dekaf: Single Message Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=100, BatchSize=100]
  ProducerBenchmarks.'Confluent: Single Message Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=100, BatchSize=100]
  ProducerBenchmarks.'Dekaf: Batch Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=100, BatchSize=100]
  ProducerBenchmarks.'Confluent: Batch Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=100, BatchSize=100]
  ProducerBenchmarks.'Dekaf: Fire-and-Forget Send': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=100, BatchSize=100]
  ProducerBenchmarks.'Dekaf: Fire-and-Forget Direct': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=100, BatchSize=100]
  ProducerBenchmarks.'Confluent: Fire-and-Forget Produce': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=100, BatchSize=100]
  ProducerBenchmarks.'Dekaf: Single Message Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=100, BatchSize=1000]
  ProducerBenchmarks.'Confluent: Single Message Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=100, BatchSize=1000]
  ProducerBenchmarks.'Dekaf: Batch Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=100, BatchSize=1000]
  ProducerBenchmarks.'Confluent: Batch Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=100, BatchSize=1000]
  ProducerBenchmarks.'Dekaf: Fire-and-Forget Send': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=100, BatchSize=1000]
  ProducerBenchmarks.'Dekaf: Fire-and-Forget Direct': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=100, BatchSize=1000]
  ProducerBenchmarks.'Confluent: Fire-and-Forget Produce': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=100, BatchSize=1000]
  ProducerBenchmarks.'Dekaf: Single Message Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=1000, BatchSize=100]
  ProducerBenchmarks.'Confluent: Single Message Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=1000, BatchSize=100]
  ProducerBenchmarks.'Dekaf: Batch Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=1000, BatchSize=100]
  ProducerBenchmarks.'Confluent: Batch Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=1000, BatchSize=100]
  ProducerBenchmarks.'Dekaf: Fire-and-Forget Send': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=1000, BatchSize=100]
  ProducerBenchmarks.'Dekaf: Fire-and-Forget Direct': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=1000, BatchSize=100]
  ProducerBenchmarks.'Confluent: Fire-and-Forget Produce': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=1000, BatchSize=100]
  ProducerBenchmarks.'Dekaf: Single Message Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=1000, BatchSize=1000]
  ProducerBenchmarks.'Confluent: Single Message Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=1000, BatchSize=1000]
  ProducerBenchmarks.'Dekaf: Batch Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=1000, BatchSize=1000]
  ProducerBenchmarks.'Confluent: Batch Produce': Job-XAIQOV(InvocationCount=1, IterationCount=10, RunStrategy=Throughput, UnrollFactor=1, WarmupCount=3) [MessageSize=1000, BatchSize=1000]
  ProducerBenchmarks.'Dekaf: Fire-and-Forget Send': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=1000, BatchSize=1000]
  ProducerBenchmarks.'Dekaf: Fire-and-Forget Direct': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=1000, BatchSize=1000]
  ProducerBenchmarks.'Confluent: Fire-and-Forget Produce': Job-FNUAAK(IterationCount=10, RunStrategy=Throughput, WarmupCount=3) [MessageSize=1000, BatchSize=1000]

// * Legends *
  MessageSize : Value of the 'MessageSize' parameter
  BatchSize   : Value of the 'BatchSize' parameter
  Mean        : Arithmetic mean of all measurements
  Error       : Half of 99.9% confidence interval
  1 ns        : 1 Nanosecond (0.000000001 sec)

// * Diagnostic Output - MemoryDiagnoser *


// ***** BenchmarkRunner: End *****
Run time: 00:31:45 (1905.32 sec), executed benchmarks: 28

Global total time: 00:31:58 (1918.45 sec), executed benchmarks: 28
// * Artifacts cleanup *
Artifacts cleanup is finished
